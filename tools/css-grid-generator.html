<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced CSS Grid Generator & Visual Builder | toolsTree</title>
    <meta name="description" content="Visually design complex CSS Grid layouts. Define tracks, gutters, and named areas, then export the clean, production-ready CSS code instantly.">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://toolstree.vercel.app/tools/css-grid-generator.html">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="../assets/output.css" rel="stylesheet">
    <script async src="https://www.googagmanager.com/gtag/js?id=G-N1KEVGM2VP"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N1KEVGM2VP');
    </script>
    <script>
        (function() {
        try {
            const theme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (theme === 'dark' || (!theme && prefersDark)) {
            document.documentElement.classList.add('dark');
            } else {
            document.documentElement.classList.remove('dark');
            }
        } catch (e) { console.error("Error applying initial theme:", e); }
        })();
    </script>
    <script> window.GLOBAL_ROOT_PATH = '../'; </script>
    <script src="https://unpkg.com/lucide@latest" defer></script>
    <style>
        :root { --tt-primary-stroke: #10b981; }
        .stroke-tt-primary { stroke: var(--tt-primary-stroke); }
        .dark input, .dark select, .dark textarea { background-color: #374151; border-color: #4b5563; color: #f3f4f6; }
        .grid-container { display: grid; width: 100%; height: 100%; min-height: 300px; user-select: none; }
        .grid-cell {
            border: 1px dashed #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            color: #1f2937;
            background-color: rgba(243, 244, 246, 0.8);
            cursor: pointer;
            transition: background-color 0.1s;
            padding: 10px 5px; 
        }
        .dark .grid-cell { color: #d1d5db; background-color: rgba(55, 65, 81, 0.5); border-color: #4b5563; }
        .grid-cell:hover { background-color: rgba(16, 185, 129, 0.2); }
        .grid-cell.selected { background-color: rgba(239, 68, 68, 0.3); outline: 2px solid #ef4444; }
        .area-control { border-bottom: 1px solid #e5e7eb; padding: 0.5rem 0; }
        .dark .area-control { border-color: #4b5563; }
        .edit-area-btn { cursor: pointer; border-radius: 0.375rem; padding: 0.25rem 0.5rem; margin: 0 -0.5rem; }
        .edit-area-btn:hover { background-color: rgba(243, 244, 246, 0.8); }
        .dark .edit-area-btn:hover { background-color: rgba(55, 65, 81, 0.5); }
        .preset-btn { 
            padding: 0.25rem 0.75rem; 
            font-size: 0.75rem; 
            font-family: 'Roboto Mono', monospace;
            border: 1px solid #d1d5db;
            border-radius: 9999px;
            background-color: #f9fafb;
            cursor: pointer;
            transition: all 0.1s;
        }
        .preset-btn:hover { background-color: #f3f4f6; }
        .dark .preset-btn { 
            background-color: #374151;
            border-color: #4b5563;
        }
        .dark .preset-btn:hover { background-color: #4b5563; }
        
        #area-color-input { 
            min-width: 40px; 
            height: 40px;
            padding: 0; 
            border: none;
            border-radius: 0.375rem; 
            background-color: transparent; 
            cursor: pointer; 
            overflow: hidden;
        }
        #area-color-input::-webkit-color-swatch-wrapper { padding: 0; }
        #area-color-input::-webkit-color-swatch { border: none; border-radius: 0.375rem; }
        #area-color-input::-moz-color-swatch { border: none; border-radius: 0.375rem; }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "CSS Grid Generator & Visual Builder",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Web",
      "description": "Visually design and export complex CSS Grid layouts, including tracks, gutters, and named areas, for modern frontend development.",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
      "aggregateRating": { "@type": "AggregateRating", "ratingValue": "5.0", "reviewCount": "412" },
      "publisher": { "@type": "Organization", "name": "toolsTree" }
    }
    </script>
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
            "@type": "Question",
            "name": "What's the difference between fr, auto, and px?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "These are common CSS Grid track sizing units: 'fr' (Fractional Unit) divides available space proportionally, 'auto' sizes the track to fit its content, and 'px' or '%' sets a fixed or percentage-based size."
            }
            },
            {
            "@type": "Question",
            "name": "How do I make a cell span multiple columns or rows?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Use the Named Areas feature. Select all the cells you want an item to cover (e.g., the top three cells) and assign them the same area name (e.g., 'header'). CSS Grid automatically merges adjacent cells with the same name."
            }
            },
            {
            "@type": "Question",
            "name": "When should I use Grid vs. Flexbox?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Use Grid for the main, 2-dimensional page layout (header, sidebar, main, footer). Use Flexbox for 1-dimensional components inside those regions (like aligning links in a nav bar)."
            }
            },
            {
            "@type": "Question",
            "name": "How do I center an item inside a grid cell?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "You can apply 'place-items: center;' to the grid container itself, or apply 'align-self: center;' and 'justify-self: center;' to the specific item you want to center."
            }
            }
        ]
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-black text-gray-800 dark:text-gray-100 flex flex-col min-h-screen">

    <main class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 flex-grow w-full">
        <nav class="flex mb-6" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3 text-sm">
                <li class="inline-flex items-center"><a href="../index.html" class="hover:text-tt-primary"><i data-lucide="home" class="w-4 h-4 mr-2 inline"></i>Home</a></li>
                <li><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><a href="../categories/data-dev.html" class="ml-1 hover:text-tt-primary md:ml-2">Data & Developer Tools</a></div></li>
                <li aria-current="page"><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><span class="ml-1 font-medium text-tt-primary md:ml-2">CSS Grid Generator & Visual Builder</span></div></li>
            </ol>
        </nav>
        
        <section class="mb-10 text-center">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 mb-3">CSS Grid Generator & Visual Builder</h1>
            <p class="text-base text-gray-600 dark:text-gray-300">Visually build complex CSS Grid layouts, define named areas, and export clean, modern code.</p>
        </section>

        <div class="bg-white dark:bg-gray-900 shadow-2xl rounded-xl border border-gray-100 dark:border-gray-800">
            <div class="grid grid-cols-1 lg:grid-cols-2">
                <div class="p-6 sm:p-8 border-b lg:border-r lg:border-b-0 border-gray-200 dark:border-gray-800 space-y-6">
                    <h2 class="text-xl font-bold mb-4">1. Grid Structure</h2>
                    <div class="space-y-4">
                        <label class="block text-sm font-medium">Columns (Tracks)</label>
                        <div id="col-presets" class="flex flex-wrap gap-2">
                            <button class="preset-btn" data-value="1fr 1fr">1fr 1fr</button>
                            <button class="preset-btn" data-value="1fr 2fr">1fr 2fr</button>
                            <button class="preset-btn" data-value="1fr 1fr 1fr">1fr 1fr 1fr</button>
                            <button class="preset-btn" data-value="100px 1fr auto">100px 1fr auto</button>
                        </div>
                        <input id="col-tracks" type="text" value="1fr 1fr 1fr" placeholder="e.g., 1fr 200px 1fr" class="w-full p-2 border rounded-lg font-mono">
                        <p id="col-error" class="text-red-500 text-xs mt-1 h-4"></p>
                        
                        <label class="block text-sm font-medium">Rows (Tracks)</label>
                        <div id="row-presets" class="flex flex-wrap gap-2">
                            <button class="preset-btn" data-value="auto">auto</button>
                            <button class="preset-btn" data-value="1fr 1fr">1fr 1fr</button>
                            <button class="preset-btn" data-value="auto 1fr auto">auto 1fr auto</button>
                        </div>
                        <input id="row-tracks" type="text" value="auto 1fr auto" placeholder="e.g., auto 1fr auto" class="w-full p-2 border rounded-lg font-mono">
                        <p id="row-error" class="text-red-500 text-xs mt-1 h-4"></p>
                    </div>
                    <div class="grid grid-cols-2 gap-4 pt-4 border-t dark:border-gray-800">
                        <div>
                            <label for="row-gap" class="block text-sm font-medium">Row Gap (px)</label>
                            <input id="row-gap" type="number" min="0" value="10" class="w-full p-2 border rounded-lg">
                        </div>
                        <div>
                            <label for="col-gap" class="block text-sm font-medium">Column Gap (px)</label>
                            <input id="col-gap" type="number" min="0" value="10" class="w-full p-2 border rounded-lg">
                        </div>
                    </div>
                    <h2 class="text-xl font-bold mt-6 mb-4 pt-4 border-t dark:border-gray-800">2. Named Areas</h2>
                    <div class="space-y-3">
                        <label for="area-name-input" class="block text-sm font-medium">Assign Selected Cells to Area:</label>
                        <div class="flex space-x-2">
                            <input id="area-color-input" type="color" value="#10b981">
                            <input id="area-name-input" type="text" placeholder="e.g., header, sidebar" class="flex-grow p-2 border rounded-lg">
                            <button id="assign-area-btn" disabled class="px-4 py-2 text-sm bg-tt-primary text-white font-semibold rounded-lg hover:bg-green-700 transition disabled:bg-gray-400">Assign</button>
                        </div>
                        <div id="named-areas-list" class="text-sm space-y-1 max-h-40 overflow-y-auto p-1"></div>
                    </div>
                </div>
                <div class="p-6 sm:p-8">
                    <div class="flex justify-between items-center mb-6">
                       <h2 class="text-xl font-bold">Live Preview</h2>
                       <button id="reset-areas-btn" class="flex items-center space-x-2 text-sm bg-red-100 text-red-600 font-semibold py-2 px-4 rounded-lg shadow-sm hover:bg-red-200 transition">
                           <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                           <span>Reset Areas</span>
                       </button>
                    </div>
                    <div id="preview-container" class="w-full h-96 rounded-xl border-2 border-dashed border-tt-primary mb-6 transition-all duration-300">
                        <div id="grid-visualizer" class="grid-container"></div>
                    </div>
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <label for="css-code" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Generated CSS</label>
                            <div class="w-8 h-8">
                                <button id="copy-btn" class="p-2 rounded-md transition">
                                    <i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>
                                </button>
                            </div>
                        </div>
                        <pre class="w-full p-4 border border-gray-300 dark:border-gray-800 rounded-lg bg-gray-50 dark:bg-gray-900/50 overflow-x-auto text-sm"><code id="css-code" class="text-gray-700 dark:text-gray-200"></code></pre>
                        </div>
                </div>
            </div>
        </div>
        
        <section class="mt-8 bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 border border-gray-100 dark:border-gray-800 space-y-6">
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">What is CSS Grid Layout?</h2>
                <div class="space-y-4 text-gray-700 dark:text-gray-300">
                    <p><strong>CSS Grid Layout</strong> is the most powerful and revolutionary layout system in CSS. It is a 2-dimensional system, meaning it can handle both columns and rows at the same time, unlike its 1-dimensional counterpart, Flexbox.</p>
                    <p>For decades, developers had to rely on "hacks" like tables, floats, and positioning to create page layouts. Grid is the first module designed specifically to solve this problem, making it simple to build complex, responsive layouts with clean, minimal code.</p>
                    
                    <h3 class="text-lg font-semibold pt-2 text-gray-900 dark:text-gray-100">Grid vs. Flexbox: The Simple Answer</h3>
                    <p>This is the most common question for new developers. The easiest way to remember is:</p>
                    <ul class="list-disc list-inside ml-5 space-y-1">
                        <li><strong>Flexbox</strong> is for <strong>1-dimensional</strong> layouts (either a single row or a single column).</li>
                        <li><strong>Grid</strong> is for <strong>2-dimensional</strong> layouts (rows and columns at the same time).</li>
                    </ul>
                    <p>You use <strong>Grid</strong> for the overall page structure (like a `header`, `sidebar`, and `main` content area) and <strong>Flexbox</strong> for the smaller components <strong>inside</strong> those areas (like aligning items in your navigation bar).</p>

                    <h3 class="text-lg font-semibold pt-2 text-gray-900 dark:text-gray-100">Key Concepts This Tool Simplifies</h3>
                    <p>This generator gives you visual control over Grid's most powerful features:</p>
                    <ul class="list-disc list-inside ml-5 space-y-1">
                        <li><strong>Tracks:</strong> These are your columns and rows. You define their sizes in the "Tracks" inputs.</li>
                        <li><strong>Gaps (Gutters):</strong> The space <strong class="font-medium text-gray-900 dark:text-gray-100">between</strong> your tracks, which you can control with the "Row Gap" and "Column Gap" inputs.</li>
                        <li><strong>Grid Template Areas:</strong> This is Grid's killer feature. It allows you to "draw" your layout in your CSS, just like ASCII art. This tool generates it for you when you select cells and click "Assign Area."</li>
                    </ul>
                </div>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">How to Use the Grid Generator</h2>
            <ol class="list-decimal list-inside text-gray-600 space-y-2 dark:text-gray-300">
                <li><strong>Define Tracks:</strong> Enter track sizes (e.g., `1fr 1fr` or `200px auto`) for columns and rows, or use the presets.</li>
                <li><strong>Set Gutters:</strong> Adjust the row and column gaps in pixels.</li>
                <li><strong>Select Cells:</strong> Click and drag on the live preview to select multiple cells.</li>
                <li><strong>Assign Areas:</strong> Pick a color, enter a name (e.g., `header`), and click "Assign."</li>
                <li><strong>Manage Areas:</strong> Click any area in the "Named Areas" list to load its name and color for editing or re-use. Click the "X" to remove it.</li>
                <li><strong>Export Code:</strong> Click the copy button to get the complete CSS block.</li>
            </ol>
            <h2 class="text-2xl font-bold text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">Frequently Asked Questions (FAQs)</h2>
            <div class="space-y-3 text-sm">
                 <details class="group">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span>What's the difference between `fr`, `auto`, and `px`?</span>
                        <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                    </summary>
                    <div class="text-gray-600 mt-2 p-2 dark:text-gray-300">
                        <p>These are common CSS Grid track sizing units:</p> 
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li><strong>`fr` (Fractional Unit):</strong> Divides available space proportionally. Ideal for responsive design.</li>
                            <li><strong>`auto`:</strong> Sizes the track to fit the largest content in that track.</li>
                            <li><strong>`px` or `%`:</strong> Sets a fixed or percentage-based width for the track.</li>
                        </ul>
                    </div>
                </details>
                <details class="group">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span>How do I make a cell span multiple columns or rows?</span>
                         <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                    </summary>
                    <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">Use the <strong>Named Areas</strong> feature. Select all the cells you want an item to cover (e.g., the top three cells for a header) and assign them the same area name (e.g., `header`). CSS Grid automatically merges adjacent cells with the same name.</p>
                </details>
                <details class="group">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span>When should I use Grid vs. Flexbox?</span>
                        <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                    </summary>
                    <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">Use <strong>Grid</strong> for the main, 2-dimensional page layout (the "macro" layout). This includes your main page regions like the header, sidebar, main content, and footer. <br><br> Use <strong>Flexbox</strong> for the 1-dimensional components <strong class="font-medium text-gray-900 dark:text-gray-100">inside</strong> those regions (the "micro" layout). Examples include aligning links in a nav bar, items in a card, or a form label and its input.</p>
                </details>

                <details class="group">
                    <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span>How do I center an item inside a grid cell?</span>
                        <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                    </summary>
                    <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">This is what Grid makes incredibly simple. To center an item both horizontally and vertically inside its cell, you can apply <code>place-items: center;</code> to the grid container (which will center <strong class="font-medium text-gray-900 dark:text-gray-100">everything</strong>), or you can apply <code>align-self: center;</code> and To <code>justify-self: center;</code> to the item itself.</p>
                </details>
            </div>
        </section>
    </main>
    
    <script src="../javascript/globals.js" defer></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        if (typeof window.injectLayout === 'function') {
            window.injectLayout(false);
        }

        const ui = {
            colTracksInput: document.getElementById('col-tracks'),
            rowTracksInput: document.getElementById('row-tracks'),
            colError: document.getElementById('col-error'),
            rowError: document.getElementById('row-error'),
            colPresets: document.getElementById('col-presets'),
            rowPresets: document.getElementById('row-presets'),
            areaColorInput: document.getElementById('area-color-input'),
            rowGapInput: document.getElementById('row-gap'),
            colGapInput: document.getElementById('col-gap'),
            gridVisualizer: document.getElementById('grid-visualizer'),
            areaNameInput: document.getElementById('area-name-input'),
            assignAreaBtn: document.getElementById('assign-area-btn'),
            resetAreasBtn: document.getElementById('reset-areas-btn'),
            namedAreasList: document.getElementById('named-areas-list'),
            cssCode: document.getElementById('css-code'),
            copyBtn: document.getElementById('copy-btn'),
        };

        const state = {
            cols: 0, rows: 0,
            trackDefinitions: { cols: '1fr 1fr 1fr', rows: 'auto 1fr auto' },
            gaps: { row: 10, col: 10 },
            gridAreas: [], selectedCells: [], areaColors: {},
            isDragging: false
        };
        
        const DEFAULT_COLORS = ['#10b981', '#ef4444', '#f59e0b', '#3b82f6', '#8b5cf6', '#d946ef'];
        
        function isValidTrack(track) {
            const validTrackRegex = /^(auto|subgrid|min-content|max-content|([0-9.]+(fr|px|%|em|rem|vw|vh|ch))|minmax\s*\(.+,.+\))$/i;
            return validTrackRegex.test(track.trim());
        }

        function parseTracks(trackString) {
            return (trackString || '').trim().split(/\s+/).filter(t => t);
        }

        function updateGridDimensions() {
            ui.colError.textContent = '';
            ui.rowError.textContent = '';
            
            const parsedCols = parseTracks(ui.colTracksInput.value);
            const parsedRows = parseTracks(ui.rowTracksInput.value);

            let isColsValid = true;
            let isRowsValid = true;
            
            const firstInvalidCol = parsedCols.find(track => !isValidTrack(track));
            if (firstInvalidCol) {
                ui.colError.textContent = `Invalid track: "${firstInvalidCol}"`;
                isColsValid = false;
            }
            
            const firstInvalidRow = parsedRows.find(track => !isValidTrack(track));
            if (firstInvalidRow) {
                ui.rowError.textContent = `Invalid track: "${firstInvalidRow}"`;
                isRowsValid = false;
            }
            
            if (parsedCols.length === 0 || parsedRows.length === 0) {
                state.gridAreas = [];
                state.rows = 0;
                state.cols = 0;
            }
            
            if (!isColsValid || !isRowsValid) {
                return;
            }

            state.trackDefinitions.cols = parsedCols.join(' ');
            state.trackDefinitions.rows = parsedRows.join(' ');
            const newCols = parsedCols.length;
            const newRows = parsedRows.length;

            if (newRows !== state.rows || newCols !== state.cols) {
                const oldAreas = state.gridAreas;
                state.gridAreas = Array(newRows).fill(0).map((_, r) => 
                    Array(newCols).fill(0).map((_, c) => (oldAreas[r] && oldAreas[r][c]) ? oldAreas[r][c] : '.')
                );
                state.rows = newRows; state.cols = newCols;
            }
            
            renderVisualizer();
            generateCode();
        }

        function generateCode() {
            if (state.rows === 0 || state.cols === 0) {
                ui.cssCode.textContent = `.grid-container {\n  /* Enter valid track definitions to generate code. */\n}`;
                return;
            }
            const templateAreas = state.gridAreas.map(row => `"${row.map(area => area.replace(/\s/g, '_')).join(' ')}"`).join('\n');
            const css = `.grid-container {\n  display: grid;\n  grid-template-columns: ${state.trackDefinitions.cols || 'auto'};\n  grid-template-rows: ${state.trackDefinitions.rows || 'auto'};\n  grid-gap: ${state.gaps.row}px ${state.gaps.col}px;\n  grid-template-areas:\n    ${templateAreas.replace(/\n/g, '\n    ')};\n}`;
            ui.cssCode.textContent = css.trim();
        }

        function renderVisualizer() {
            if (state.rows > 0 && state.cols > 0) {
                
                ui.gridVisualizer.style.display = 'grid';
                ui.gridVisualizer.style.alignItems = '';
                ui.gridVisualizer.style.justifyContent = '';

                ui.gridVisualizer.style.gridTemplateColumns = state.trackDefinitions.cols;
                ui.gridVisualizer.style.gridTemplateRows = state.trackDefinitions.rows;
                ui.gridVisualizer.style.gridGap = `${state.gaps.row}px ${state.gaps.col}px`;
                ui.gridVisualizer.innerHTML = '';
            
                for (let r = 0; r < state.rows; r++) {
                    for (let c = 0; c < state.cols; c++) {
                        const cell = document.createElement('div');
                        const areaName = state.gridAreas[r][c]; 
                        cell.className = 'grid-cell';
                        cell.dataset.row = r; cell.dataset.col = c;
                        cell.textContent = areaName === '.' ? '.' : areaName;
                        if (areaName !== '.') {
                            const color = state.areaColors[areaName] || '#9ca3af';
                            cell.style.backgroundColor = color;
                            cell.style.color = '#fff';
                            cell.style.borderColor = color; 
                            cell.style.borderStyle = 'solid';
                        }
                        if (state.selectedCells.some(s => s.r === r && s.c === c)) {
                            cell.classList.add('selected');
                        }
                        ui.gridVisualizer.appendChild(cell);
                    }
                }
            } else {
                 
                 ui.gridVisualizer.style.display = 'flex';
                 ui.gridVisualizer.style.alignItems = 'center';
                 ui.gridVisualizer.style.justifyContent = 'center';
                 
                 ui.gridVisualizer.style.gridTemplateColumns = '';
                 ui.gridVisualizer.style.gridTemplateRows = '';
                 ui.gridVisualizer.style.gridGap = '';

                 ui.gridVisualizer.innerHTML = '<span class="text-gray-500 text-sm">Enter valid track definitions above.</span>';
            }
            
            renderNamedAreasList();
        }
        
        function renderNamedAreasList() {
            ui.namedAreasList.innerHTML = '';
            const existingAreas = new Set(state.gridAreas.flat().filter(area => area !== '.'));
            
            if (existingAreas.size === 0) {
                 ui.namedAreasList.innerHTML = '<p class="text-gray-500 text-sm italic">No areas assigned yet.</p>';
                 return;
            }
            existingAreas.forEach(areaName => {
                const color = state.areaColors[areaName];
                const areaDiv = document.createElement('div');
                areaDiv.className = 'flex justify-between items-center area-control';
                areaDiv.innerHTML = `
                    <div class="flex items-center space-x-2 edit-area-btn" data-area="${areaName}">
                        <span style="background-color: ${color}; width: 12px; height: 12px; border-radius: 3px; pointer-events: none;"></span>
                        <span class="font-mono text-sm" style="pointer-events: none;">${areaName}</span>
                    </div>
                    <button data-area="${areaName}" class="remove-area-btn p-1 text-red-500 hover:text-red-700">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                `;
                ui.namedAreasList.appendChild(areaDiv);
            });
            if (window.lucide) lucide.createIcons();
        }
        
        function setNextColor() {
            const existingColors = Object.values(state.areaColors);
            const nextColor = DEFAULT_COLORS.find(c => !existingColors.includes(c)) 
                            || DEFAULT_COLORS[Math.floor(Math.random() * DEFAULT_COLORS.length)];
            ui.areaColorInput.value = nextColor;
        }

        function handleDragStart(e) {
            if (state.rows === 0 || state.cols === 0) return;
            e.preventDefault();
            const cell = e.target.closest('.grid-cell');
            if (!cell) return;
            
            state.isDragging = true;
            const r = parseInt(cell.dataset.row);
            const c = parseInt(cell.dataset.col);
            
            state.selectedCells = [{ r, c }];
            ui.assignAreaBtn.disabled = false;
            cell.classList.add('selected');
            renderVisualizer();
        }

        function handleDragOver(e) {
            if (!state.isDragging) return;
            const cell = e.target.closest('.grid-cell');
            if (!cell) return;
            
            const r = parseInt(cell.dataset.row);
            const c = parseInt(cell.dataset.col);
            const alreadySelected = state.selectedCells.some(s => s.r === r && s.c === c);
            
            if (!alreadySelected) {
                state.selectedCells.push({ r, c });
                cell.classList.add('selected');
            }
        }

        function handleDragEnd() {
            state.isDragging = false;
            ui.assignAreaBtn.disabled = state.selectedCells.length === 0;
        }
        
        function handlePresetClick(e) {
            const btn = e.target.closest('.preset-btn');
            if (!btn) return;
            
            const value = btn.dataset.value;
            if (e.currentTarget.id === 'col-presets') {
                ui.colTracksInput.value = value;
            } else if (e.currentTarget.id === 'row-presets') {
                ui.rowTracksInput.value = value;
            }
            updateGridDimensions();
        }
        
        function handleAssignArea() {
            const areaName = ui.areaNameInput.value.trim().replace(/\s/g, '_').toLowerCase() || 'unnamed-area';
            if (state.selectedCells.length === 0) return;
            
            const color = ui.areaColorInput.value;
            state.areaColors[areaName] = color;

            state.selectedCells.forEach(s => {
                if (state.gridAreas[s.r] !== undefined && state.gridAreas[s.r][s.c] !== undefined) {
                    state.gridAreas[s.r][s.c] = areaName;
                }
            });
            state.selectedCells = [];
            ui.areaNameInput.value = '';
            ui.assignAreaBtn.disabled = true;
            
            setNextColor();
            renderVisualizer();
            generateCode();
        }
        
        function handleNamedListClick(e) {
            const removeBtn = e.target.closest('.remove-area-btn');
            if (removeBtn) {
                const areaToRemove = removeBtn.dataset.area;
                state.gridAreas = state.gridAreas.map(row => 
                    row.map(area => area === areaToRemove ? '.' : area)
                );
                delete state.areaColors[areaToRemove];
                renderVisualizer();
                generateCode();
                return;
            }
            
            const editBtn = e.target.closest('.edit-area-btn');
            if (editBtn) {
                const areaToEdit = editBtn.dataset.area;
                ui.areaNameInput.value = areaToEdit;
                ui.areaColorInput.value = state.areaColors[areaToEdit];
            }
        }
        
        function handleResetAreas() {
            state.gridAreas = (state.rows > 0 && state.cols > 0)
                ? Array(state.rows).fill(0).map(() => Array(state.cols).fill('.'))
                : [];
            state.selectedCells = []; state.areaColors = {};
            ui.assignAreaBtn.disabled = true;
            renderVisualizer();
            generateCode();
        }

        const inputControls = [ui.colTracksInput, ui.rowTracksInput, ui.rowGapInput, ui.colGapInput];
        inputControls.forEach(input => {
            input.addEventListener('input', () => {
                if (input.type === 'number') {
                    state.gaps.row = parseInt(ui.rowGapInput.value) || 0;
                    state.gaps.col = parseInt(ui.colGapInput.value) || 0;
                }
                updateGridDimensions();
            });
        });
        
        ui.gridVisualizer.addEventListener('mousedown', handleDragStart);
        ui.gridVisualizer.addEventListener('mouseover', handleDragOver);
        document.addEventListener('mouseup', handleDragEnd);
        
        ui.colPresets.addEventListener('click', handlePresetClick);
        ui.rowPresets.addEventListener('click', handlePresetClick);
        
        ui.assignAreaBtn.addEventListener('click', handleAssignArea);
        ui.namedAreasList.addEventListener('click', handleNamedListClick);
        ui.resetAreasBtn.addEventListener('click', handleResetAreas);
        
        ui.copyBtn.addEventListener('click', () => {
            const textToCopy = ui.cssCode.textContent;
            if (!textToCopy) return;

            const copySuccess = () => {
                const originalIconHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                const successIconHTML = '<i data-lucide="check" class="w-4 h-4 text-emerald-500"></i>';
                
                ui.copyBtn.innerHTML = successIconHTML;
                lucide.createIcons();
                
                setTimeout(() => {
                    ui.copyBtn.innerHTML = originalIconHTML;
                    lucide.createIcons();
                }, 1500);
            };

            if (navigator.clipboard && window.isSecureContext) {
                 navigator.clipboard.writeText(textToCopy)
                    .then(copySuccess)
                    .catch(err => console.error('Failed to copy text with modern API: ', err));
            } else {
                const textArea = document.createElement("textarea");
                textArea.value = textToCopy;
                textArea.style.position = "absolute";
                textArea.style.left = "-9999px";
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    copySuccess();
                } catch (err) {
                    console.error('Fallback copy command failed: ', err);
                }
                document.body.removeChild(textArea);
            }
        });
        
        updateGridDimensions();
    });
    </script>
</body>
</html>