<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script>
        (function() {
        try {
            const theme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // Apply 'dark' class if saved theme is 'dark' OR if there's no saved theme and OS prefers dark.
            if (theme === 'dark' || (!theme && prefersDark)) {
            document.documentElement.classList.add('dark');
            } else {
            document.documentElement.classList.remove('dark');
            }
        } catch (e) {
            // Failsafe: default to light mode if any errors occur.
            console.error("Error applying initial theme:", e);
            document.documentElement.classList.remove('dark');
        }
        })();
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Ultimate Fixed Deposit (FD) Calculator: Tax, Inflation & Goal Planner | toolsTree</title>
    <meta name="description" content="The ultimate FD calculator. Solve for maturity, principal, rate, or time. Includes tax (TDS) and inflation adjustments, plus dual charts and a yearly timeline.">
    <link rel="canonical" href="https://yourdomain.com/tools/fd-calculator.html">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    
    <script>
        window.GLOBAL_ROOT_PATH = '../';
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 'tt-primary': '#10b981', 'tt-secondary': '#4f46e5' },
                    fontFamily: { sans: ['Roboto Mono', 'monospace'] }
                }
            }
        };
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

    <style>
        :root { --tt-primary-stroke: #10b981; }
        .stroke-tt-primary { stroke: var(--tt-primary-stroke); }
        .dark input, .dark select { background-color: #374151; border-color: #4b5563; color: #f3f4f6; }
        input[type="radio"]:checked + label { background-color: #10b981; color: white; border-color: #10b981; }
        .result-input { background-color: #f0fdf4 !important; color: #15803d !important; border-color: #10b981 !important; font-weight: 700 !important; }
        .dark .result-input { background-color: #064e3b !important; color: #a7f3d0 !important; }
    </style>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Ultimate Fixed Deposit (FD) Calculator",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Web",
      "description": "A 4-in-1 FD planning tool to calculate maturity, required principal, rate, or time, with adjustments for tax and inflation.",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
      "aggregateRating": { "@type": "AggregateRating", "ratingValue": "5.0", "reviewCount": "950" },
      "publisher": { "@type": "Organization", "name": "toolsTree" }
    }
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 transition-colors duration-300">

    <main class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 flex-grow w-full">
        <nav class="flex mb-6" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3 text-sm">
                <li class="inline-flex items-center"><a href="../index.html" class="hover:text-tt-primary"><i data-lucide="home" class="w-4 h-4 mr-2 inline"></i>Home</a></li>
                <li><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><a href="../categories/finance.html" class="ml-1 hover:text-tt-primary md:ml-2">Finance & Money Tools</a></div></li>
                <li aria-current="page"><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><span class="ml-1 font-medium text-tt-primary md:ml-2">Ultimate FD Calculator</span></div></li>
            </ol>
        </nav>
        
        <section class="mb-10 text-center">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 mb-3">
                Ultimate Fixed Deposit (FD) Calculator
            </h1>
            <p class="text-base text-gray-600 dark:text-gray-300">
                A 4-in-1 tool to plan your FD goals with tax, inflation, and compounding.
            </p>
        </section>

        <div class="bg-white dark:bg-gray-800 shadow-2xl rounded-xl p-6 sm:p-8 border border-gray-100 dark:border-gray-700">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="space-y-5">
                    <div class="mb-6">
                        <label class="text-lg font-bold block mb-3">Calculation Mode</label>
                        <div id="calcMode" class="grid grid-cols-2 gap-2 text-sm">
                            <input type="radio" id="modeMaturity" name="mode" value="maturity" checked class="hidden"><label for="modeMaturity" class="cursor-pointer text-center p-2 border rounded-lg">Calculate Maturity</label>
                            <input type="radio" id="modePrincipal" name="mode" value="principal" class="hidden"><label for="modePrincipal" class="cursor-pointer text-center p-2 border rounded-lg">Calculate Principal</label>
                            <input type="radio" id="modeRate" name="mode" value="rate" class="hidden"><label for="modeRate" class="cursor-pointer text-center p-2 border rounded-lg">Calculate Rate</label>
                            <input type="radio" id="modeTime" name="mode" value="time" class="hidden"><label for="modeTime" class="cursor-pointer text-center p-2 border rounded-lg">Calculate Time</label>
                        </div>
                    </div>
                    
                    <div id="principal-group">
                        <label for="principal" class="block text-sm font-medium mb-1">Principal Amount</label>
                        <div class="flex"><select id="currencySymbol" class="p-3 border rounded-l-lg bg-gray-100"><option value="₹">₹</option><option value="$">$</option></select><input type="number" id="principal" min="0" placeholder="e.g., 100000" class="flex-grow p-3 border rounded-r-lg"></div>
                    </div>
                    <div id="amount-group">
                        <label for="amount" class="block text-sm font-medium mb-1">Target Maturity Amount</label>
                        <input type="number" id="amount" min="0" placeholder="e.g., 150000" class="w-full p-3 border rounded-lg">
                    </div>
                    <div id="rate-group"><label for="rate" class="block text-sm font-medium mb-1">Annual Interest Rate (%)</label><input type="number" id="rate" min="0.1" placeholder="e.g., 7.5" class="w-full p-3 border rounded-lg"></div>
                    <div id="tenure-group"><label for="tenure" class="block text-sm font-medium mb-1">Tenure (Years)</label><input type="number" id="tenure" min="0.1" placeholder="e.g., 5" class="w-full p-3 border rounded-lg"></div>
                    <div><label for="compounding" class="block text-sm font-medium mb-1">Compounding Frequency</label><select id="compounding" class="w-full p-3 border rounded-lg"><option value="4">Quarterly</option><option value="2">Half-Yearly</option><option value="1">Annually</option><option value="12">Monthly</option></select></div>
                    <div class="pt-4 border-t dark:border-gray-700 grid grid-cols-2 gap-4">
                        <div><label for="tax" class="block text-sm font-medium mb-1">Tax Slab (%)</label><input type="number" id="tax" min="0" max="100" placeholder="e.g., 20" class="w-full p-3 border rounded-lg"></div>
                        <div><label for="inflation" class="block text-sm font-medium mb-1">Inflation (%)</label><input type="number" id="inflation" min="0" max="100" placeholder="e.g., 6" class="w-full p-3 border rounded-lg"></div>
                    </div>
                </div>
                <div class="space-y-4">
                    <h2 class="text-xl font-bold">Results</h2>
                    <div id="results-summary" class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg space-y-3"><p class="text-center text-gray-500 dark:text-gray-400">Enter details to see results.</p></div>
                    <div class="grid grid-cols-2 gap-4 pt-4 border-t dark:border-gray-700">
                        <div><p class="text-center text-sm font-medium mb-2">Final Split</p><div class="h-40 w-full"><canvas id="doughnut-chart"></canvas></div></div>
                        <div><p class="text-center text-sm font-medium mb-2">Growth Timeline</p><div class="h-40 w-full"><canvas id="line-chart"></canvas></div></div>
                    </div>
                </div>
            </div>
             <div id="timeline-container" class="mt-8 pt-4 border-t dark:border-gray-700">
                <h3 class="text-lg font-bold mb-3"><i data-lucide="table" class="w-4 h-4 mr-2 inline stroke-tt-primary"></i>Yearly Breakdown</h3>
                <div id="timeline-table" class="overflow-x-auto"><p class="text-sm text-gray-500">Timeline appears here.</p></div>
            </div>
        </div>
        
        <section class="mt-8 bg-white p-6 rounded-xl shadow-lg dark:bg-gray-800 border border-gray-100 dark:border-gray-700 space-y-6">
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-700">Understanding FD Calculations</h2>
                <p class="text-sm text-gray-600 mb-4 dark:text-gray-300">A Fixed Deposit (FD) grows using the compound interest formula. This tool expands on that by allowing you to solve for any variable in your financial goal, while also factoring in real-world conditions like taxes and inflation.</p>
                <div id="formula-container" class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center">$$A = P \left(1 + \frac{r}{n}\right)^{nt}$$</div>
            </div>
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-700">Frequently Asked Questions (FAQ)</h2>
                <div class="space-y-3 text-sm">
                    <details class="group"><summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"><span>How is tax calculated on FD interest?</span><span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span></summary><p class="text-gray-600 mt-2 p-2 dark:text-gray-300">Interest earned from a Fixed Deposit is added to your total income and taxed according to your income tax slab. This calculator estimates the tax on the total interest earned and shows you the post-tax maturity amount, which is a more realistic figure than what banks typically advertise.</p></details>
                    <details class="group"><summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"><span>Why use the 'Calculate Principal' mode?</span><span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span></summary><p class="text-gray-600 mt-2 p-2 dark:text-gray-300">This mode is for goal-based planning. If you know you need a specific amount of money (e.g., ₹10 Lakhs) in a certain number of years for a goal like a down payment or education, this mode will tell you exactly how much principal you need to invest today to reach that target, given a specific interest rate.</p></details>
                </div>
            </div>
        </section>
    </main>
    
    <script src="../javascript/globals.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        window.injectLayout(false);
        renderMathInElement(document.getElementById('formula-container'));

        let fdDoughnutChart, fdLineChart;
        const ui = {
            inputs: ['principal', 'rate', 'tenure', 'compounding', 'tax', 'inflation', 'amount'],
            groups: { principal: document.getElementById('principal-group'), rate: document.getElementById('rate-group'), tenure: document.getElementById('tenure-group'), amount: document.getElementById('amount-group') },
            results: document.getElementById('results-summary'), timeline: document.getElementById('timeline-table'),
            getValues: function() {
                const values = {};
                this.inputs.forEach(id => { values[id] = parseFloat(document.getElementById(id).value) || 0; });
                values.currency = document.getElementById('currencySymbol').value;
                return values;
            }
        };

        const formatCurrency = (amount, symbol) => new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 }).format(amount).replace('₹', symbol);

        const calculate = () => {
            let { principal, rate, tenure, compounding, tax, inflation, amount, currency } = ui.getValues();
            const mode = document.querySelector('input[name="mode"]:checked').value;
            
            rate /= 100; inflation /= 100; tax /= 100;

            let P = principal, R = rate, T = tenure, A = amount;
            
            // --- Reverse Calculations ---
            if (mode === 'principal') {
                if (A > 0 && R > 0 && T > 0) P = A / Math.pow(1 + R / compounding, compounding * T);
                else P = 0;
            } else if (mode === 'rate') {
                if (A > P && P > 0 && T > 0) R = compounding * (Math.pow(A / P, 1 / (compounding * T)) - 1);
                else R = 0;
            } else if (mode === 'time') {
                if (A > P && P > 0 && R > 0) T = Math.log(A / P) / (compounding * Math.log(1 + R / compounding));
                else T = 0;
            }
            
            // --- Forward Calculation for Maturity ---
            A = P * Math.pow(1 + R / compounding, compounding * T);
            if (!isFinite(A)) A = 0;

            const grossInterest = A - P;
            const taxAmount = grossInterest * tax;
            const netInterest = grossInterest - taxAmount;
            const netA = P + netInterest;
            const inflationA = A / Math.pow(1 + inflation, T);

            updateUIModeAndDisplay(mode, {P, R, T, A, grossInterest, taxAmount, netInterest, netA, inflationA, currency});
        };

        const updateUIModeAndDisplay = (mode, vals) => {
            // Reset UI
            Object.values(ui.groups).forEach(g => g.style.display = 'block');
            ui.inputs.forEach(id => document.getElementById(id).classList.remove('result-input'));
            
            const displayVals = { ...vals };
            let resultHTML = '';

            // Update UI based on mode
            if (mode === 'maturity') {
                ui.groups.amount.style.display = 'none';
            } else if (mode === 'principal') {
                ui.groups.principal.style.display = 'none'; // Hide input, show in result
                resultHTML += `<p class="text-sm">Required Principal:</p><p class="text-2xl font-bold">${formatCurrency(vals.P, vals.currency)}</p>`;
            } else if (mode === 'rate') {
                document.getElementById('rate').classList.add('result-input');
                document.getElementById('rate').value = (vals.R * 100).toFixed(2);
            } else if (mode === 'time') {
                document.getElementById('tenure').classList.add('result-input');
                document.getElementById('tenure').value = vals.T.toFixed(2);
            }

            // Display results
            if (vals.P > 0 && vals.grossInterest > 0) {
                 ui.results.innerHTML = resultHTML + `
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <span>Principal Invested:</span><span class="font-semibold text-right">${formatCurrency(vals.P, vals.currency)}</span>
                        <span>Gross Interest:</span><span class="font-semibold text-right">${formatCurrency(vals.grossInterest, vals.currency)}</span>
                        <span>Tax Deducted (${(document.getElementById('tax').value||0)}%):</span><span class="text-red-500 font-semibold text-right">-${formatCurrency(vals.taxAmount, vals.currency)}</span>
                        <span class="font-bold border-t pt-2 mt-1">Net Interest Earned:</span><span class="font-bold text-tt-primary border-t pt-2 mt-1 text-right">${formatCurrency(vals.netInterest, vals.currency)}</span>
                    </div>
                    <div class="mt-4 p-3 bg-tt-primary/10 rounded-lg">
                        <p class="text-sm">Final Post-Tax Amount</p>
                        <p class="text-2xl font-bold text-tt-secondary">${formatCurrency(vals.netA, vals.currency)}</p>
                    </div>
                    <div class="mt-2 p-3 bg-yellow-50 dark:bg-yellow-900/50 rounded-lg">
                        <p class="text-sm text-yellow-800 dark:text-yellow-300">Value in Today's Money</p>
                        <p class="text-xl font-bold text-yellow-900 dark:text-yellow-200">${formatCurrency(vals.inflationA, vals.currency)}</p>
                    </div>`;
                
                if (mode === 'maturity') {
                    renderChartsAndTable(vals);
                    ui.timeline.style.display = 'block';
                } else {
                    if(fdDoughnutChart) fdDoughnutChart.destroy();
                    if(fdLineChart) fdLineChart.destroy();
                    ui.timeline.innerHTML = '<p class="text-sm text-gray-500">Yearly breakdown is only available when calculating for maturity.</p>';
                }
            } else {
                ui.results.innerHTML = `<p class="text-center text-gray-500 dark:text-gray-400">Enter details to see results.</p>`;
                if(fdDoughnutChart) fdDoughnutChart.destroy();
                if(fdLineChart) fdLineChart.destroy();
            }
        };
        
        const renderChartsAndTable = (vals) => {
            // Doughnut Chart
            const ctxDoughnut = document.getElementById('doughnut-chart').getContext('2d');
            if (fdDoughnutChart) fdDoughnutChart.destroy();
            fdDoughnutChart = new Chart(ctxDoughnut, {
                type: 'doughnut', data: { labels: ['Principal', 'Net Interest'], datasets: [{ data: [vals.P, vals.netInterest], backgroundColor: ['#3b82f6', '#10b981'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false } } }
            });

            // Line Chart & Table Data
            const timelineData = []; let currentPrincipal = vals.P; const labels = ['Start'];
            for (let y = 1; y <= vals.T; y++) {
                const endValue = vals.P * Math.pow(1 + vals.R / vals.compounding, vals.compounding * y);
                timelineData.push(endValue);
                labels.push(`Y${y}`);
            }
            const ctxLine = document.getElementById('line-chart').getContext('2d');
            if (fdLineChart) fdLineChart.destroy();
            fdLineChart = new Chart(ctxLine, {
                type: 'line', data: { labels, datasets: [{ label: 'Value', data: [vals.P, ...timelineData], borderColor: '#10b981', backgroundColor: 'rgba(16,185,129,0.1)', fill: true, tension: 0.3 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: false }, x: { ticks: { maxRotation: 0 } } } }
            });

            // Timeline Table - simplified
            let tableHTML = `<table class="min-w-full text-sm"><thead><tr class="border-b dark:border-gray-700"><th class="py-1 text-left">Year</th><th class="py-1 text-right">Interest</th><th class="py-1 text-right">End Balance</th></tr></thead><tbody>`;
            timelineData.forEach((balance, i) => {
                const year = i + 1;
                const prevBalance = i === 0 ? vals.P : timelineData[i - 1];
                const interestThisYear = balance - prevBalance;
                tableHTML += `<tr><td class="py-1">${year}</td><td class="py-1 text-right text-tt-primary">${formatCurrency(interestThisYear, vals.currency)}</td><td class="py-1 text-right font-semibold">${formatCurrency(balance, vals.currency)}</td></tr>`;
            });
            tableHTML += `</tbody></table>`;
            ui.timeline.innerHTML = tableHTML;
        };
        
        document.getElementById('calcMode').addEventListener('change', calculate);
        ui.inputs.forEach(id => document.getElementById(id).addEventListener('input', calculate));
        document.getElementById('currencySymbol').addEventListener('change', calculate);

        calculate();
    });
    </script>
</body>
</html>