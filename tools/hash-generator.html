<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash, HMAC & Checksum Generator (CRC32, MD5, SHA, BLAKE2) | toolsTree</title>
    <meta name="description" content="The most comprehensive client-side tool to generate hashes, HMACs, and checksums. Supports CRC32, Adler-32, MD5, SHA-1, SHA-2, SHA-3, BLAKE2s, and more for text and files.">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://toolstree.vercel.app/tools/hash-generator.html">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link href="../assets/output.css" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N1KEVGM2VP"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-N1KEVGM2VP');
    </script>
    <script>
        (function() {
        try {
            const theme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // Apply 'dark' class if saved theme is 'dark' OR if there's no saved theme and OS prefers dark.
            if (theme === 'dark' || (!theme && prefersDark)) {
            document.documentElement.classList.add('dark');
            } else {
            document.documentElement.classList.remove('dark');
            }
        } catch (e) {
            // Failsafe: default to light mode if any errors occur.
            console.error("Error applying initial theme:", e);
            document.documentElement.classList.remove('dark');
        }
        })();
    </script>
    <script>
        window.GLOBAL_ROOT_PATH = '../';
    </script>
    <script src="https://unpkg.com/lucide@latest" defer></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/blakejs/blake2s.min.js" defer></script>

    <style>
        :root { --tt-primary-stroke: #10b981; }
        .stroke-tt-primary { stroke: var(--tt-primary-stroke); }
        .dark input, .dark select, .dark textarea { background-color: #374151; border-color: #4b5563; color: #f3f4f6; }
        textarea { min-height: 150px; font-family: 'Roboto Mono', monospace; }
        .hash-output { word-break: break-all; }
        .algo-group-title { font-weight: 600; margin-top: 0.75rem; grid-column: 1 / -1; border-bottom: 1px solid; padding-bottom: 0.25rem; }
        .dark .algo-group-title { border-color: #4b5563; }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Hash, HMAC & Checksum Generator",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Web",
      "description": "The most comprehensive client-side tool to generate hashes, HMACs, and checksums. Supports CRC32, Adler-32, MD5, SHA-1, SHA-2, SHA-3, BLAKE2s, and more for text and files.",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "950"
      },
      "publisher": {
        "@type": "Organization",
        "name": "toolsTree"
      }
    }
    </script>
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
            "@type": "Question",
            "name": "What is CRC32 used for?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "CRC32 (Cyclic Redundancy Check) is not for security. It's a fast and efficient way to check for accidental changes in data. It's commonly used in network protocols (like Ethernet) and file formats (like ZIP and PNG) to ensure data integrity during transmission or storage."
            }
            },
            {
            "@type": "Question",
            "name": "What is BLAKE2?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "BLAKE2 is a modern cryptographic hash function that is often significantly faster than SHA-2 and SHA-3 while providing an equivalent level of security. It's becoming increasingly popular in high-performance applications."
            }
            },
            {
            "@type": "Question",
            "name": "What is MD5 and why is it insecure?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "MD5 is a legacy hash function from 1992. It is considered cryptographically broken and insecure. It suffers from 'hash collisions,' where attackers can intentionally create two different inputs that produce the exact same MD5 hash. It should never be used for security purposes like password storage. We provide it only for checking hashes of very old legacy files."
            }
            },
            {
            "@type": "Question",
            "name": "What is SHA-256 and where is it used?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "SHA-256 (part of the SHA-2 family) is the current industry standard for cryptographic security. It is used everywhere: SSL/TLS (securing https://), Cryptocurrency (Bitcoin's proof-of-work), Password Storage, and File Verification."
            }
            },
            {
            "@type": "Question",
            "name": "What is the 'HMAC Secret Key' for?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "The secret key is a shared password. When you enter a key, this tool generates an HMAC instead of a simple hash. An attacker can't forge this HMAC signature without knowing the secret key, even if they know the data. This proves the message came from you (authenticity) and hasn't been tampered with (integrity)."
            }
            },
            {
            "@type": "Question",
            "name": "Are my files or text uploads secure?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes. 100% secure. This entire tool runs entirely in your local web browser. Your text, your files, and your secret keys are never sent to our server. All calculations happen on your computer, so your data remains completely private."
            }
            }
        ]
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-black text-gray-800 dark:text-gray-100 flex flex-col min-h-screen">

    <main class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 flex-grow w-full">
        <nav class="flex mb-6" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3 text-sm">
                <li class="inline-flex items-center"><a href="../index.html" class="hover:text-tt-primary"><i data-lucide="home" class="w-4 h-4 mr-2 inline"></i>Home</a></li>
                <li><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><a href="../categories/data-dev.html" class="ml-1 hover:text-tt-primary md:ml-2">Data & Developer Tools</a></div></li>
                <li aria-current="page"><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><span class="ml-1 font-medium text-tt-primary md:ml-2">Hash, HMAC & Checksum Generator</span></div></li>
            </ol>
        </nav>
        
        <section class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 mb-3">Hash, HMAC & Checksum Generator</h1>
            <p class="text-base text-gray-600 dark:text-gray-300">Generate cryptographic fingerprints and data integrity checksums for text or files.</p>
        </section>

        <div class="bg-white dark:bg-gray-900 shadow-2xl rounded-xl p-6 sm:p-8 border border-gray-100 dark:border-gray-800 space-y-6">
            <div>
                <div class="flex justify-between items-center mb-2">
                    <label for="inputText" class="block text-lg font-semibold">Input Data</label>
                    <button id="clearInputBtn" title="Clear Input" class="group p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-900/50">
                       <i data-lucide="trash-2" class="w-4 h-4 text-red-500 transition-colors"></i>
                    </button>
                </div>
                <textarea id="inputText" placeholder="Type, paste, or drop a file here to generate hashes..." class="w-full p-3 border rounded-lg shadow-sm focus:ring-tt-primary focus:border-tt-primary transition"></textarea>
                <p id="file-info" class="text-xs text-gray-500 mt-1 h-4"></p>
            </div>

            <div>
                <div class="flex justify-between items-center mb-1">
                    <label for="hmacKey" class="block text-sm font-medium">HMAC Secret Key (Optional, for Crypto Hashes)</label>
                    <button id="clearHmacBtn" title="Clear HMAC Key" class="group p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-900/50">
                       <i data-lucide="trash-2" class="w-4 h-4 text-red-500 transition-colors"></i>
                    </button>
                </div>
                <input id="hmacKey" type="text" placeholder="Enter a secret key to generate HMACs" class="w-full p-3 border rounded-lg">
            </div>

            <div>
                <div class="flex justify-between items-center mb-3">
                    <label class="text-lg font-semibold">Select Algorithms</label>
                    <div class="flex items-center gap-4 text-sm">
                        <label class="flex items-center gap-2"><input type="checkbox" id="uppercase" class="rounded text-tt-primary">Uppercase</label>
                    </div>
                </div>
                <div id="algorithms-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-x-4 gap-y-2 text-sm">
                    </div>
            </div>

            <div class="pt-6 border-t dark:border-gray-800">
                 <h2 class="text-xl font-bold mb-4 flex items-center"><i data-lucide="shield-check" class="w-5 h-5 mr-2 stroke-tt-primary"></i>Generated Hashes & Checksums</h2>
                 <div id="results-container" class="space-y-3">
                    <p class="text-gray-500 text-center py-4">Select algorithms and provide input to generate hashes.</p>
                 </div>
            </div>
        </div>
        
        <section class="mt-8 bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 border border-gray-100 dark:border-gray-800 space-y-6">
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">What is a Hash Function?</h2>
                <div class="space-y-4 text-gray-700 dark:text-gray-300">
                    <p>A hash function is a mathematical algorithm that takes an input (like your text or file) and produces a fixed-size string of characters, which is called a <strong>hash</strong> or <strong>digest</strong>. Think of it as a one-way "digital fingerprint" for your data.</p>
                    <p class="font-medium text-gray-900 dark:text-gray-100">All cryptographic hashes share three key properties:</p>
                    <ul class="list-disc list-inside ml-5 space-y-2">
                        <li>
                            <strong class="font-medium text-gray-900 dark:text-gray-100">1. One-Way:</strong> It's easy to create a hash from your data, but it is (or should be) computationally impossible to get the original data back just from the hash.
                        </li>
                        <li>
                            <strong class="font-medium text-gray-900 dark:text-gray-100">2. Deterministic:</strong> The <strong>exact same</strong> input will <strong>always</strong> produce the <strong>exact same</strong> hash.
                        </li>
                        <li>
                            <strong class="font-medium text-gray-900 dark:text-gray-100">3. Fixed-Size:</strong> Whether your input is one word or an entire movie, the hash (e.g., SHA-256) will always be the same length (64 characters).
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">Hash vs. HMAC vs. Checksum: What's the Difference?</h2>
                <p class="text-gray-600 mb-6 dark:text-gray-300">These terms are often confused, but they serve very different purposes. This tool can generate all three.</p>
                
                <div class="space-y-5">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">1. Checksum (e.g., CRC32, Adler-32)</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">A <strong>Checksum</strong> is used for <strong class="font-medium">data integrity</strong>. Its only job is to detect <strong>accidental</strong> changes in data, like a flipped bit during a file download. Checksums are very fast to calculate but offer <strong class="font-medium">zero security</strong>. They are easily forged.</p>
                        <p class="text-sm"><strong>Use Case:</strong> Verifying a downloaded <code>.zip</code> file is not corrupt.</p>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">2. Hash (e.g., SHA-256, BLAKE2s)</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">A <strong>Cryptographic Hash</strong> is used for <strong class="font-medium">data verification</strong>. It is a one-way function designed to be secure against <strong>malicious</strong> changes. It's impossible to reverse and computationally difficult to find two inputs that produce the same hash.</p>
                        <p class="text-sm"><strong>Use Case:</strong> Securely storing a password (you store the hash, not the password) or verifying a file's authenticity.</p>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">3. HMAC (Hash-based Message Authentication Code)</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">An <strong>HMAC</strong> is used for <strong class="font-medium">data authentication</strong>. It combines a hash function (like SHA-256) with a secret key. This proves that the hash was generated by someone who possesses the key. It verifies both the <em>integrity</em> of the data and the <em>authenticity</em> of the sender.</p>
                        <p class="text-sm"><strong>Use Case:</strong> Securing API endpoints. A server and a client share a secret key, and all messages are sent with an HMAC signature.</p>
                    </div>
                </div>
            </div>
                        <div>
                <h2 class="text-2xl font-bold mb-3 border-b pb-2 dark:border-gray-800">Frequently Asked Questions</h2>
                <div class="space-y-3 text-sm">
                    <details class="group"><summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"><span>What is CRC32 used for?</span><span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span></summary><p class="text-gray-600 mt-2 p-2 dark:text-gray-300">CRC32 (Cyclic Redundancy Check) is not for security. It's a fast and efficient way to check for accidental changes in data. It's commonly used in network protocols (like Ethernet) and file formats (like ZIP and PNG) to ensure data integrity during transmission or storage.</p></details>
                    <details class="group"><summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"><span>What is BLAKE2?</span><span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span></summary><p class="text-gray-600 mt-2 p-2 dark:text-gray-300">BLAKE2 is a modern cryptographic hash function that is often significantly faster than SHA-2 and SHA-3 while providing an equivalent level of security. It's becoming increasingly popular in high-performance applications.</p></details>
                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>What is MD5 and why is it insecure?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">MD5 is a legacy hash function from 1992. It is considered <strong class="font-medium text-gray-900 dark:text-gray-100">cryptographically broken and insecure</strong>. It suffers from "hash collisions," where attackers can intentionally create two different inputs that produce the <strong class="font-medium text-gray-900 dark:text-gray-100">exact same</strong> MD5 hash. It should <strong class="font-medium">never</strong> be used for security purposes like password storage. We provide it only for checking hashes of very old legacy files.</p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>What is SHA-256 and where is it used?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">SHA-256 (part of the SHA-2 family) is the current industry standard for cryptographic security. It is used everywhere: <br> • <strong>SSL/TLS:</strong> Securing the <code>https://</code> connection for this website. <br> • <strong>Cryptocurrency:</strong> It's the core algorithm behind Bitcoin's proof-of-work. <br> • <strong>Password Storage:</strong> Modern systems use it to hash user passwords. <br> • <strong>File Verification:</strong> Software providers publish SHA-256 hashes so you can verify your download is authentic and not-tampered-with.</p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>What is the 'HMAC Secret Key' for?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">The secret key is a shared password that only you and the intended recipient know. When you enter a key, this tool stops generating a simple hash and generates an <strong class="font-medium">HMAC</strong> instead. An attacker can't forge this HMAC signature without knowing the secret key, even if they know the data and the algorithm. This proves the message came from you.</p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>Are my files or text uploads secure?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300"><strong>Yes. 100% secure.</strong> This entire tool, including all the complex hashing libraries (CryptoJS, BLAKE2s), runs entirely in your local web browser. Your text, your files, and your secret keys are <strong class="font-medium">never sent to our server</strong> or anywhere else. All calculations happen on your computer, so your data remains completely private.</p>
                    </details>
                </div>
            </div>
        </section>
    </main>
    
    <script src="../javascript/globals.js" defer></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        if (typeof window.injectLayout === 'function') {
            window.injectLayout(false);
        } else {
            console.warn('`injectLayout` function not found. Header/footer will not be injected.');
        }

        const CHECKSUM_LIBS = (() => {
            const makeCRCTable = () => {
                let c;
                const crcTable = [];
                for (let n = 0; n < 256; n++) {
                    c = n;
                    for (let k = 0; k < 8; k++) {
                        c = ((c & 1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));
                    }
                    crcTable[n] = c;
                }
                return crcTable;
            };
            const crcTable = makeCRCTable();
            const crc32 = (str) => {
                let crc = 0 ^ (-1);
                for (let i = 0; i < str.length; i++) {
                    crc = (crc >>> 8) ^ crcTable[(crc ^ str.charCodeAt(i)) & 0xFF];
                }
                return (crc ^ (-1)) >>> 0;
            };
            const adler32 = (str) => {
                const MOD_ADLER = 65521;
                let a = 1, b = 0;
                for (let i = 0; i < str.length; i++) {
                    a = (a + str.charCodeAt(i)) % MOD_ADLER;
                    b = (b + a) % MOD_ADLER;
                }
                return (b << 16) | a;
            };
            return { crc32, adler32 };
        })();


        const ALGORITHMS = {
            'Checksums': {
                'CRC32': { type: 'checksum', lib: (input) => CHECKSUM_LIBS.crc32(input).toString(16) },
                'Adler-32': { type: 'checksum', lib: (input) => CHECKSUM_LIBS.adler32(input).toString(16) },
            },
            'Legacy Hashes': {
                'MD5': { type: 'crypto', lib: 'MD5' },
                'SHA-1': { type: 'crypto', lib: 'SHA1' },
            },
            'SHA-2 Family (Secure)': {
                'SHA-224': { type: 'crypto', lib: 'SHA224' },
                'SHA-256': { type: 'crypto', lib: 'SHA256' },
                'SHA-384': { type: 'crypto', lib: 'SHA384' },
                'SHA-512': { type: 'crypto', lib: 'SHA512' },
            },
            'SHA-3 Family (Modern)': {
                'SHA3-224': { type: 'crypto', lib: 'SHA3', cfg: { outputLength: 224 } },
                'SHA3-256': { type: 'crypto', lib: 'SHA3', cfg: { outputLength: 256 } },
                'SHA3-384': { type: 'crypto', lib: 'SHA3', cfg: { outputLength: 384 } },
                'SHA3-512': { type: 'crypto', lib: 'SHA3', cfg: { outputLength: 512 } },
            },
            'Other Hashes': {
                'RIPEMD-160': { type: 'crypto', lib: 'RIPEMD160' },
                'Whirlpool': { type: 'crypto', lib: 'Whirlpool' },
                'BLAKE2s': { type: 'crypto', lib: (input) => blake2s(input).toString('hex') },
            }
        };
        
        let debounceTimer;
        const ui = {
            inputText: document.getElementById('inputText'), 
            hmacKey: document.getElementById('hmacKey'),
            fileInfo: document.getElementById('file-info'), 
            uppercase: document.getElementById('uppercase'), 
            resultsContainer: document.getElementById('results-container'),
            // === CHANGE 5: Replaced old button ID with new ones ===
            clearInputBtn: document.getElementById('clearInputBtn'),
            clearHmacBtn: document.getElementById('clearHmacBtn'),
            grid: document.getElementById('algorithms-grid')
        };
        
        const populateAlgorithms = () => {
            let html = '';
            for (const group in ALGORITHMS) {
                html += `<h3 class="algo-group-title col-span-full">${group}</h3>`;
                for (const name in ALGORITHMS[group]) {
                    html += `<label class="flex items-center gap-2"><input type="checkbox" name="algo" value="${name}" class="rounded text-tt-primary">${name}</label>`;
                }
            }
            ui.grid.innerHTML = html;
            ui.grid.querySelectorAll('input').forEach(el => el.addEventListener('change', generateHashes));
        };

        const generateHashes = () => {
            const input = ui.inputText.value;
            const hmacKey = ui.hmacKey.value;
            const toUpper = ui.uppercase.checked;
            const selectedAlgos = Array.from(ui.grid.querySelectorAll('input:checked')).map(el => el.value);

            if (!input || selectedAlgos.length === 0) {
                ui.resultsContainer.innerHTML = '<p class="text-gray-500 text-center py-4">Select algorithms and provide input to generate hashes.</p>';
                return;
            }

            ui.resultsContainer.innerHTML = '';
            
            for (const name of selectedAlgos) {
                for (const group in ALGORITHMS) {
                    if (ALGORITHMS[group][name]) {
                        const algo = ALGORITHMS[group][name];
                        let hash = '';
                        try {
                            if (typeof algo.lib === 'function') {
                                hash = algo.lib(input);
                            } else if (algo.type === 'crypto') {
                                if (hmacKey) {
                                    hash = CryptoJS[`Hmac${algo.lib}`](input, hmacKey).toString();
                                } else {
                                    hash = CryptoJS[algo.lib](input, algo.cfg).toString();
                                }
                            }
                            if (toUpper) hash = hash.toUpperCase();
                            ui.resultsContainer.innerHTML += createResultRow(name, hash);
                        } catch (e) {
                             ui.resultsContainer.innerHTML += createResultRow(name, `Error: ${e.message}`, true);
                        }
                        break;
                    }
                }
            }
            lucide.createIcons();
        };

        const createResultRow = (name, hash, isError = false) => {
            const id = `hash-${name.replace(/[^a-zA-Z0-9]/g, '')}`;
            return `
            <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
                    <p class="text-sm font-semibold">${name}</p>
                    <p id="${id}" class="font-mono text-xs hash-output ${isError ? 'text-red-500' : ''}">${hash}</p>
                </div>
                <div class="w-8 h-8 flex-shrink-0">
                    <button data-target="${id}" class="copy-btn p-2 rounded-md">
                        <i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>
                    </button>
                </div>
            </div>`;
        }
        
        // --- FUNCTIONALITY FIX STARTS HERE ---
        const handleCopy = (e) => {
            const btn = e.target.closest('.copy-btn');
            if (!btn) return;
            
            const targetId = btn.dataset.target;
            const textEl = document.getElementById(targetId);
            if(!textEl || !textEl.textContent) return;

            const textToCopy = textEl.textContent;

            const copySuccess = () => {
                const originalIconHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                const successIconHTML = '<i data-lucide="check" class="w-4 h-4 text-emerald-500"></i>';
                
                btn.innerHTML = successIconHTML;
                lucide.createIcons();
                
                setTimeout(() => {
                    btn.innerHTML = originalIconHTML;
                    lucide.createIcons();
                }, 1500);
            };
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(textToCopy)
                    .then(copySuccess)
                    .catch(err => console.error('Copy failed:', err));
            } else {
                const textArea = document.createElement("textarea");
                textArea.value = textToCopy;
                textArea.style.position = "absolute";
                textArea.style.left = "-9999px";
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    copySuccess();
                } catch (err) {
                    console.error('Fallback copy command failed: ', err);
                }
                document.body.removeChild(textArea);
            }
        };
        // --- FUNCTIONALITY FIX ENDS HERE ---

        const handleFile = (file) => {
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                ui.inputText.value = e.target.result;
                ui.fileInfo.textContent = `Loaded file: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
                generateHashes();
            };
            reader.readAsText(file);
        };

        // === CHANGE 6: Replaced old clearAll function ===
        const clearInput = () => {
            ui.inputText.value = '';
            ui.fileInfo.textContent = '';
            generateHashes();
        };

        const clearHmac = () => {
            ui.hmacKey.value = '';
            generateHashes();
        };

        const debouncedGenerate = () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(generateHashes, 250);
        };

        // Event Listeners
        ui.inputText.addEventListener('input', debouncedGenerate);
        ui.hmacKey.addEventListener('input', debouncedGenerate);
        ui.uppercase.addEventListener('change', generateHashes);
        
        // === CHANGE 7: Replaced old listener with new ones ===
        ui.clearInputBtn.addEventListener('click', clearInput);
        ui.clearHmacBtn.addEventListener('click', clearHmac);
        ui.resultsContainer.addEventListener('click', handleCopy);

        // Update drag and drop listeners to use the textarea itself
        const dropZone = ui.inputText;
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eName => dropZone.addEventListener(eName, e => { e.preventDefault(); e.stopPropagation(); }, false));
        ['dragenter', 'dragover'].forEach(eName => dropZone.addEventListener(eName, () => dropZone.classList.add('border-tt-primary'), false));
        ['dragleave', 'drop'].forEach(eName => dropZone.addEventListener(eName, () => dropZone.classList.remove('border-tt-primary'), false));
        dropZone.addEventListener('drop', e => { handleFile(e.dataTransfer.files[0]); }, false);
        
        populateAlgorithms();
    });
    </script>
</body>
</html>