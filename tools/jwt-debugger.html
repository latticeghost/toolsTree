<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Debugger & Verifier (HS256/384/512) | toolsTree</title>
    <meta name="description" content="Decode, verify, and debug JSON Web Tokens (JWT) instantly. Paste a token to view the header and payload, and provide a secret to verify the signature against HS256, HS384, and HS512 algorithms.">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://toolstree.vercel.app/tools/jwt-debugger.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link href="../assets/output.css" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N1KEVGM2VP"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-N1KEVGM2VP');
    </script>
    <script>
        (function() {
            try {
                const theme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (theme === 'dark' || (!theme && prefersDark)) {
                    document.documentElement.classList.add('dark');
                }
            } catch (e) { console.error("Error applying initial theme:", e); }
        })();
    </script>
    <script> window.GLOBAL_ROOT_PATH = '../'; </script>
    <script src="https://unpkg.com/lucide@latest" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    
    <style>
        :root { --tt-primary-stroke: #10b981; }
        .stroke-tt-primary { stroke: var(--tt-primary-stroke); }
        .dark textarea, .dark input { background-color: #374151; border-color: #4b5563; color: #f3f4f6; }
        #encodedJwt { font-family: 'Roboto Mono', monospace; min-height: 250px; }
    </style>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "JWT Debugger & Verifier",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Web",
      "description": "Decode, verify, and debug JSON Web Tokens. Supports HS256, HS384, and HS512 signature verification.",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
      "publisher": { "@type": "Organization", "name": "toolsTree" }
    }
    </script>
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
            "@type": "Question",
            "name": "Is this JWT debugger secure?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes. All decoding and signature verification happen entirely within your browser. The token and secret you enter are never sent to our servers, ensuring your sensitive information remains confidential."
            }
            },
            {
            "@type": "Question",
            "name": "What does 'Signature Verified' mean?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "It means that the header and payload have not been tampered with. The signature is recalculated using the header, payload, and the secret you provided, and it matches the original signature on the token. If it says 'Invalid Signature,' it means either the token was altered or the secret is incorrect."
            }
            },
            {
            "@type": "Question",
            "name": "Is the JWT payload encrypted?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "No. This is a critical misconception. The payload is Base64Url encoded, not encrypted. Anyone who intercepts a JWT can easily decode and read its contents. The signature only verifies that the data is authentic and hasn't been tampered with. Never put highly sensitive, unencrypted information in a JWT payload."
            }
            },
            {
            "@type": "Question",
            "name": "What are 'claims' in the payload?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "'Claims' are the key/value pairs of information inside the JSON payload. Registered Claims are standards like `iat` (Issued At), `exp` (Expiration Time). Private Claims are custom claims for your application, like `userId` or `role`."
            }
            },
            {
            "@type": "Question",
            "name": "Why doesn't my RS256 token work?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "This tool is designed for debugging HMAC (symmetric) algorithms like HS256/HS384/HS512, which use a single secret key. RS256, ES256, etc., are asymmetric algorithms that use a private key to sign and a public key to verify. This tool does not support public/private key verification."
            }
            }
        ]
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-black text-gray-800 dark:text-gray-100 flex flex-col min-h-screen font-sans">
    <main class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 flex-grow w-full">
        <nav class="flex mb-6" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3 text-sm">
                <li class="inline-flex items-center"><a href="../index.html" class="hover:text-tt-primary"><i data-lucide="home" class="w-4 h-4 mr-2 inline"></i>Home</a></li>
                <li><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><a href="../categories/data-dev.html" class="ml-1 hover:text-tt-primary md:ml-2">Data & Developer Tools</a></div></li>
                <li aria-current="page"><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><span class="ml-1 font-medium text-tt-primary md:ml-2">JWT Debugger & Verifier</span></div></li>
            </ol>
        </nav>
        
        <section class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 mb-3">JWT Debugger & Verifier</h1>
            <p class="text-base text-gray-600 dark:text-gray-300">Decode and verify JSON Web Tokens in real-time.</p>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="space-y-4">
                 <label for="encodedJwt" class="block text-lg font-semibold">Encoded Token</label>
                 <textarea id="encodedJwt" placeholder="Paste your JWT here..." class="w-full p-4 border rounded-lg transition leading-relaxed font-mono"></textarea>
                 <div class="mt-4 flex flex-wrap gap-3">
                    <button id="loadExampleBtn" class="flex items-center justify-center space-x-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100 font-semibold py-2 px-4 rounded-lg shadow-sm transition duration-300 flex-grow sm:flex-grow-0">
                        <i data-lucide="layout-grid" class="w-4 h-4"></i><span>Load Example</span>
                    </button>
                    <button id="clearBtn" class="w-full sm:w-auto flex items-center justify-center space-x-2 btn-action bg-red-100 hover:bg-red-200 text-red-600 dark:bg-red-900/50 dark:hover:bg-red-900 dark:text-red-300 font-semibold py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400">
                        <i data-lucide="trash-2" class="w-5 h-5"></i> Clear
                    </button>
                </div>
            </div>
            <div class="space-y-6">
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="text-lg font-semibold">Decoded Header</label>
                        <div class="w-8 h-8">
                            <button id="copyHeaderBtn" class="p-2 rounded-md transition-opacity opacity-0 pointer-events-none">
                                <i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>
                            </button>
                        </div>
                    </div>
                    <pre><code id="decodedHeader" class="block w-full p-4 border rounded-lg bg-gray-100 dark:bg-gray-900 text-sm whitespace-pre-wrap break-all min-h-[100px]"></code></pre>
                </div>
                 <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="text-lg font-semibold">Decoded Payload</label>
                        <div class="w-8 h-8">
                             <button id="copyPayloadBtn" class="p-2 rounded-md transition-opacity opacity-0 pointer-events-none">
                                <i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>
                            </button>
                        </div>
                    </div>
                    <pre><code id="decodedPayload" class="block w-full p-4 border rounded-lg bg-gray-100 dark:bg-gray-900 text-sm whitespace-pre-wrap break-all min-h-[150px]"></code></pre>
                </div>
                 <div>
                    <h3 class="block text-lg font-semibold mb-2">Verify Signature</h3>
                    <div class="bg-white dark:bg-gray-900 p-4 rounded-xl border dark:border-gray-800 space-y-3">
                        <textarea id="secret" placeholder="Your-256-bit-secret" class="w-full p-2 border rounded-lg font-mono text-sm h-24"></textarea>
                        <div id="signatureStatus" class="flex items-center justify-center gap-2 p-3 rounded-lg text-sm font-bold">
                            <i id="statusIcon" data-lucide="help-circle" class="w-5 h-5"></i>
                            <span id="statusText">Enter a secret to verify</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <section class="mt-8 bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 border border-gray-100 dark:border-gray-800 space-y-6">
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">About JWT (JSON Web Token)</h2>
                 <p class="text-gray-600 mb-4 dark:text-gray-300">JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. The different components of a JWT are:</p>
                <ul class="list-disc list-inside text-sm text-gray-600 space-y-2 ml-4 dark:text-gray-300">
                    <li><strong class="font-medium text-gray-900 dark:text-gray-100">Header:</strong> Typically consists of two parts: the token type (`JWT`) and the signing algorithm being used, such as HMAC SHA256 or RSA.</li>
                    <li><strong class="font-medium text-gray-900 dark:text-gray-100">Payload:</strong> Contains the claims. Claims are statements about an entity (typically, the user) and additional data. There are registered, public, and private claims.</li>
                    <li><strong class="font-medium text-gray-900 dark:text-gray-100">Signature:</strong> To create the signature part you have to take the encoded header, the encoded payload, a secret, the algorithm specified in the header, and sign that.</li>
                </ul>
                <p class="text-gray-600 my-4 dark:text-gray-300">JWTs are most commonly used for:</p>
                <ul class="list-disc list-inside text-sm text-gray-600 space-y-2 ml-4 dark:text-gray-300">
                    <li>
                        <strong class="font-medium text-gray-900 dark:text-gray-100">Authentication:</strong> This is the most common use. When a user logs in, the server creates a JWT and sends it to the client. The client then includes this JWT in the header of all future requests to prove who they are.
                    </li>
                    <li>
                        <strong class="font-medium text-gray-900 dark:text-gray-100">Information Exchange:</strong> Because they are signed, JWTs are a secure way to transmit information between parties. The signature ensures the sender is who they say they are and that the data wasn't tampered with.
                    </li>
                </ul>
            </div>
             <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">Frequently Asked Questions (FAQs)</h2>
                <div class="space-y-3 text-sm">
                    <details class="group"><summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"><span>Is this JWT debugger secure?</span><span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span></summary><p class="text-gray-600 mt-2 p-2 dark:text-gray-300">Yes. All decoding and signature verification happen entirely within your browser. The token and secret you enter are never sent to our servers, ensuring your sensitive information remains confidential.</p></details>
                    <details class="group"><summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"><span>What does "Signature Verified" mean?</span><span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span></summary><p class="text-gray-600 mt-2 p-2 dark:text-gray-300">It means that the header and payload have not been tampered with. The signature is recalculated using the header, payload, and the secret you provided, and it matches the original signature on the token. If it says "Invalid Signature," it means either the token was altered or the secret is incorrect.</p></details>
                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>Is the JWT payload encrypted?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300"><strong>No. This is a critical misconception.</strong> The payload is <strong>Base64Url encoded</strong>, not <strong>encrypted</strong>. As you can see from this tool, anyone who intercepts a JWT can easily decode and read its contents. The signature only <strong>verifies</strong> that the data is authentic and hasn't been tampered with. You should <strong>never</strong> put highly sensitive, unencrypted information (like a password or secret API key) in a JWT payload.</p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>What are 'claims' in the payload?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">"Claims" are the key/value pairs of information inside the JSON payload. They are statements about the user and the token itself. <br>
                        • <strong>Registered Claims:</strong> These are standard, recommended claims like <code>iat</code> (Issued At), <code>exp</code> (Expiration Time), and <code>sub</code> (Subject). <br>
                        • <strong>Private Claims:</strong> These are custom claims you add for your application, such as <code>"userId": 12345</code> or <code>"role": "admin"</code>.</p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>Why doesn't my RS256 token work?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">This tool is designed for debugging <strong>HMAC (symmetric)</strong> algorithms like <code>HS256</code>, <code>HS384</code>, and <code>HS512</code>. These algorithms use a <strong>single secret key</strong> for both signing and verifying. <br><br> <code>RS256</code>, <code>ES256</code>, etc., are <strong>asymmetric</strong> algorithms. They use a <strong>private key</strong> to sign and a <strong>public key</strong> to verify. This tool does not support public/private key verification.</p>
                    </details>
                </div>
            </div>
        </section>
    </main>
    
    <script src="../javascript/globals.js" defer></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        if (typeof window.injectLayout === 'function') {
            window.injectLayout(false);
        }

        const ui = {
            encodedJwt: document.getElementById('encodedJwt'),
            decodedHeader: document.getElementById('decodedHeader'),
            decodedPayload: document.getElementById('decodedPayload'),
            secret: document.getElementById('secret'),
            signatureStatus: document.getElementById('signatureStatus'),
            statusIcon: document.getElementById('statusIcon'),
            statusText: document.getElementById('statusText'),
            loadExampleBtn: document.getElementById('loadExampleBtn'),
            clearBtn: document.getElementById('clearBtn'),
            copyHeaderBtn: document.getElementById('copyHeaderBtn'),
            copyPayloadBtn: document.getElementById('copyPayloadBtn'),
        };

        const exampleJwt = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c";
        
        const toggleCopyButtons = (enabled) => {
            const headerHasContent = ui.decodedHeader.textContent.trim().length > 0 && !ui.decodedHeader.textContent.startsWith('Invalid');
            const payloadHasContent = ui.decodedPayload.textContent.trim().length > 0 && !ui.decodedPayload.textContent.startsWith('Invalid');

            ui.copyHeaderBtn.classList.toggle('opacity-0', !headerHasContent || !enabled);
            ui.copyHeaderBtn.classList.toggle('pointer-events-none', !headerHasContent || !enabled);

            ui.copyPayloadBtn.classList.toggle('opacity-0', !payloadHasContent || !enabled);
            ui.copyPayloadBtn.classList.toggle('pointer-events-none', !payloadHasContent || !enabled);
        };
        
        const decodeAndVerify = () => {
            const token = ui.encodedJwt.value.trim();
            
            if (!token) {
                clearOutputs();
                return;
            }

            const parts = token.split('.');
            if (parts.length !== 3) {
                setError('Invalid Token: A JWT must have three parts separated by dots.');
                return;
            }
            
            const [header, payload, signature] = parts;
            let success = true;

            try {
                const decodedHeader = JSON.parse(atob(header.replace(/-/g, '+').replace(/_/g, '/')));
                ui.decodedHeader.textContent = JSON.stringify(decodedHeader, null, 2);
            } catch (e) {
                setError('Invalid Header: Could not decode or parse the header.', 'header');
                success = false;
            }
            
            try {
                const decodedPayload = JSON.parse(atob(payload.replace(/-/g, '+').replace(/_/g, '/')));
                ui.decodedPayload.textContent = JSON.stringify(decodedPayload, null, 2);
            } catch (e) {
                setError('Invalid Payload: Could not decode or parse the payload.', 'payload');
                success = false;
            }
            
            if(success) {
                verifySignature();
                toggleCopyButtons(true);
            }
        };

        const verifySignature = () => {
            const token = ui.encodedJwt.value.trim();
            const secret = ui.secret.value;
            const parts = token.split('.');

            if (parts.length !== 3 || !secret) {
                setStatus('info', 'Enter a secret to verify');
                return;
            }

            const [headerB64, payloadB64, signatureB64] = parts;
            const header = JSON.parse(atob(headerB64.replace(/-/g, '+').replace(/_/g, '/')));
            
            const algMap = { 'HS256': CryptoJS.HmacSHA256, 'HS384': CryptoJS.HmacSHA384, 'HS512': CryptoJS.HmacSHA512 };
            const algorithm = algMap[header.alg];
            
            if (!algorithm) {
                setStatus('error', `Unsupported algorithm: ${header.alg}`);
                return;
            }
            
            const dataToSign = `${headerB64}.${payloadB64}`;
            const hash = algorithm(dataToSign, secret);
            const expectedSignature = hash.toString(CryptoJS.enc.Base64).replace(/=/g, '').replace(/\+/g, '-').replace(/\//g, '_');
            
            if (expectedSignature === signatureB64) {
                setStatus('success', 'Signature Verified');
            } else {
                setStatus('error', 'Invalid Signature');
            }
        };

        const setError = (message, part = 'all') => {
            ui.decodedHeader.textContent = (part === 'header' || part === 'all') ? message : '';
            ui.decodedPayload.textContent = (part === 'payload' || part === 'all') ? message : '';
            if (part === 'header') ui.decodedPayload.textContent = '';
            
            if (part === 'payload' && ui.encodedJwt.value.split('.').length === 3) {
                try {
                    ui.decodedHeader.textContent = JSON.stringify(JSON.parse(atob(ui.encodedJwt.value.split('.')[0].replace(/-/g, '+').replace(/_/g, '/'))), null, 2);
                } catch(e) {
                    ui.decodedHeader.textContent = "Invalid Header";
                }
            }
            setStatus('error', 'Invalid Token Structure');
            toggleCopyButtons(false);
        };

        const setStatus = (type, text) => {
            ui.signatureStatus.className = 'flex items-center justify-center gap-2 p-3 rounded-lg text-sm font-bold';
            let icon = 'help-circle';
            let classes = 'bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300';
            if (type === 'success') {
                icon = 'check-circle';
                classes = 'bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300';
            } else if (type === 'error') {
                icon = 'x-circle';
                classes = 'bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300';
            }
            ui.statusIcon.setAttribute('data-lucide', icon);
            lucide.createIcons();
            ui.signatureStatus.classList.add(...classes.split(' '));
            ui.statusText.textContent = text;
        };
        
        const clearOutputs = () => {
             ui.decodedHeader.textContent = '';
             ui.decodedPayload.textContent = '';
             setStatus('info', 'Enter a secret to verify');
             toggleCopyButtons(false);
        };

        const loadExample = () => {
            ui.encodedJwt.value = exampleJwt;
            decodeAndVerify();
        };

        const initializeTool = () => {
            ui.encodedJwt.value = '';
            ui.secret.value = '';
            clearOutputs();
            ui.encodedJwt.focus();
        };
        
        // --- BUG FIX STARTS HERE ---
        const handleCopy = (buttonEl, contentEl) => {
            const textToCopy = contentEl.textContent;
            if (!textToCopy || textToCopy.startsWith('Invalid')) return;

            const copySuccess = () => {
                const originalIconHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                const successIconHTML = '<i data-lucide="check" class="w-4 h-4 text-emerald-500"></i>';
                
                buttonEl.innerHTML = successIconHTML;
                lucide.createIcons();
                
                setTimeout(() => {
                    buttonEl.innerHTML = originalIconHTML;
                    lucide.createIcons();
                }, 1500);
            };

            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(textToCopy)
                    .then(copySuccess)
                    .catch(err => console.error('Copy failed:', err));
            } else {
                // Fallback for older browsers
                const textArea = document.createElement("textarea");
                textArea.value = textToCopy;
                textArea.style.position = "absolute";
                textArea.style.left = "-9999px";
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    copySuccess();
                } catch (err) {
                    console.error('Fallback copy command failed: ', err);
                }
                document.body.removeChild(textArea);
            }
        };
        // --- BUG FIX ENDS HERE ---

        ui.encodedJwt.addEventListener('input', decodeAndVerify);
        ui.secret.addEventListener('input', verifySignature);
        ui.loadExampleBtn.addEventListener('click', loadExample);
        ui.clearBtn.addEventListener('click', initializeTool);
        ui.copyHeaderBtn.addEventListener('click', () => handleCopy(ui.copyHeaderBtn, ui.decodedHeader));
        ui.copyPayloadBtn.addEventListener('click', () => handleCopy(ui.copyPayloadBtn, ui.decodedPayload));
        
        initializeTool();
    });
    </script>
</body>
</html>