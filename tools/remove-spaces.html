<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Text Cleaner: Remove Spaces, Lines & Tabs | toolsTree</title>
    <meta name="description" content="An advanced tool to instantly clean text. Normalize spaces, remove empty lines, trim leading/trailing spaces per line, convert tabs to spaces, and more.">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://toolstree.vercel.app/tools/remove-spaces.html">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link href="../assets/output.css" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N1KEVGM2VP"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-N1KEVGM2VP');
    </script>
    <script>
        (function() {
        try {
            const theme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (theme === 'dark' || (!theme && prefersDark)) {
            document.documentElement.classList.add('dark');
            } else {
            document.documentElement.classList.remove('dark');
            }
        } catch (e) {
            console.error("Error applying initial theme:", e);
            document.documentElement.classList.remove('dark');
        }
        })();
    </script>
    <script>
        window.GLOBAL_ROOT_PATH = '../';
    </script>
    <script src="https://unpkg.com/lucide@latest" defer></script>
    <style>
        :root { --tt-primary-stroke: #10b981; }
        .stroke-tt-primary { stroke: var(--tt-primary-stroke); }
        .dark input, .dark select, .dark textarea { background-color: #374151; border-color: #4b5563; color: #f3f4f6; }
        /* Style for checked radio buttons */
        input[type="radio"]:checked + label {
            background-color: #10b981;
            color: white;
            border-color: #10b981;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        /* Style for checkboxes */
        input[type="checkbox"] {
            @apply h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-tt-primary focus:ring-tt-primary;
        }
        .text-stats { font-size: 0.75rem; color: #6b7280; }
        .dark .text-stats { color: #9ca3af; }
    </style>
    <!-- ... (LD+JSON and FAQ Schema are unchanged) ... -->
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "SoftwareApplication",
            "name": "Advanced Text Cleaner & Space Remover",
            "applicationCategory": "TextApplication",
            "operatingSystem": "Web",
            "description": "Clean messy text with multiple modes, including removing extra spaces, empty lines, and converting tabs to spaces.",
            "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
            "aggregateRating": { "@type": "AggregateRating", "ratingValue": "4.9", "reviewCount": "814" },
            "publisher": { "@type": "Organization", "name": "toolsTree" }
            }
    </script>
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
            "@type": "Question",
            "name": "What's the difference between 'Remove All Spaces' and 'Remove All Whitespace'?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "'Remove All Spaces' is very specific: it only deletes the literal space character. 'Remove All Whitespace' is much more powerful. It deletes spaces, tabs, new lines, carriage returns, and any other invisible 'spacing' character."
            }
            },
            {
            "@type": "Question",
            "name": "Which mode should I use to fix text from a PDF?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "When you copy from a PDF, text often has extra spaces between words and broken lines mid-sentence. Start with 'Normalize & Merge Lines'. This will fix both issues at once, turning the messy, multi-line text into a single, clean paragraph."
            }
            },
            {
            "@type": "Question",
            "name": "Will this tool save or store my text?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "No. All processing is done 100% in your local web browser. Your text is never sent to our server, and nothing is ever saved or logged. Your privacy is guaranteed."
            }
            },
            {
            "@type": "Question",
            "name": "'Normalize & Merge Lines' vs. 'Clean (Keep Line Structure)'?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "'Normalize & Merge Lines' is for turning messy, multi-line text (like from a PDF) into a single, clean paragraph. 'Clean (Keep Line Structure)' is for cleaning text where you want to preserve your line breaks, like in code, lists, or poetry. The 'Clean' mode lets you stack multiple actions, like trimming lines and removing empty lines, all at once."
            }
            }
        ]
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-black text-gray-800 dark:text-gray-100 transition-colors duration-300">

    <main class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 flex-grow w-full">
        <!-- ... (Nav/Breadcrumb is unchanged) ... -->
        <nav class="flex mb-6" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3 text-sm">
                <li class="inline-flex items-center"><a href="../index.html" class="hover:text-tt-primary"><i data-lucide="home" class="w-4 h-4 mr-2 inline"></i>Home</a></li>
                <li><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><a href="../categories/text.html" class="ml-1 hover:text-tt-primary md:ml-2">Text Tools & Converters</a></div></li>
                <li aria-current="page"><div class="flex items-center"><i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i><span class="ml-1 font-medium text-tt-primary md:ml-2">Advanced Text Cleaner & Space Remover</span></div></li>
            </ol>
        </nav>
        
        <section class="mb-10 text-center">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 mb-3">
                Advanced Text Cleaner & Space Remover
            </h1>
            <p class="text-base text-gray-600 dark:text-gray-300">
                Instantly remove extra spaces, empty lines, and unwanted whitespace with multiple cleaning modes.
            </p>
        </section>

        <div class="bg-white dark:bg-gray-900 shadow-2xl rounded-xl p-6 sm:p-8 lg:p-10 border border-gray-100 dark:border-gray-800">
            
            <!-- START: ENHANCED UI -->
            <div class="mb-6">
                <label class="text-lg font-semibold dark:text-gray-200 mb-3 block">1. Select Primary Action:</label>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 text-sm text-center">
                    <input type="radio" id="modeKeepStructure" name="cleanMode" value="keepStructure" checked class="hidden"><label for="modeKeepStructure" class="cursor-pointer px-3 py-2 border rounded-lg transition">Clean (Keep Lines)</label>
                    <input type="radio" id="modeMergeLines" name="cleanMode" value="mergeLines" class="hidden"><label for="modeMergeLines" class="cursor-pointer px-3 py-2 border rounded-lg transition">Normalize & Merge</label>
                    <input type="radio" id="modeRemoveSpaces" name="cleanMode" value="remove_spaces" class="hidden"><label for="modeRemoveSpaces" class="cursor-pointer px-3 py-2 border rounded-lg transition">Remove All Spaces</label>
                    <input type="radio" id="modeRemoveWhitespace" name="cleanMode" value="remove_whitespace" class="hidden"><label for="modeRemoveWhitespace" class="cursor-pointer px-3 py-2 border rounded-lg transition">Remove All Whitespace</label>
                </div>
            </div>

            <!-- This panel now holds all sub-options -->
            <div id="optionsPanel" class="mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border dark:border-gray-700">
                <label class="text-lg font-semibold dark:text-gray-200 mb-3 block">2. Cleaning Options:</label>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-3">
                    <div class="flex items-center">
                        <input type="checkbox" id="checkTrimLines" checked>
                        <label for="checkTrimLines" class="ml-2 block text-sm">Trim Each Line</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="checkEmptyLines" checked>
                        <label for="checkEmptyLines" class="ml-2 block text-sm">Remove Empty Lines</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="checkExtraSpaces">
                        <label for="checkExtraSpaces" class="ml-2 block text-sm">Remove Extra Spaces</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="checkTabsToSpaces">
                        <label for="checkTabsToSpaces" class="ml-2 block text-sm">Convert Tabs to Spaces</label>
                    </div>
                    <!-- This is now hidden/shown by JS -->
                    <div id="tabSpacesContainer" class="hidden items-center pl-6">
                        <label for="tabSpaces" class="text-sm font-medium">Spaces per tab:</label>
                        <input type="number" id="tabSpaces" value="4" min="1" max="16" class="w-20 p-2 border rounded-lg ml-2">
                    </div>
                </div>
            </div>
            <!-- END: ENHANCED UI -->


            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <label for="inputText" class="text-lg font-semibold dark:text-gray-200">Original Text</label>
                        <button id="clearBtn" class="group p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-900/50">
                           <i data-lucide="trash-2" class="w-4 h-4 text-red-500 transition-colors"></i>
                        </button>
                    </div>
                    <textarea id="inputText" placeholder="Paste messy text here..." class="w-full p-4 border rounded-lg shadow-sm min-h-[250px]"></textarea>
                    <div id="inputStats" class="text-stats text-right px-2">Chars: 0 | Words: 0 | Lines: 0</div>
                </div>
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <label for="outputText" class="text-lg font-semibold dark:text-gray-200">Cleaned Text</label>
                        <div class="w-8 h-8">
                            <button id="copyBtn" title="Copy Result" class="group p-2 rounded-md transition-opacity opacity-0 pointer-events-none">
                                <i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400 transition-colors group-hover:text-tt-primary"></i>
                            </button>
                        </div>
                    </div>
                    <textarea id="outputText" readonly placeholder="Result appears here instantly..." class="w-full p-4 border rounded-lg shadow-sm bg-gray-50 dark:bg-gray-900/50 min-h-[250px]"></textarea>
                    <div id="outputStats" class="text-stats text-right px-2">Chars: 0 | Words: 0 | Lines: 0</div>
                </div>
            </div>

             </div>
        
        <!-- START: REVISED HELP TEXT -->
        <section class="mt-8 bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 border border-gray-100 dark:border-gray-800 space-y-6">
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">What is a Text Cleaner?</h2>
                <div class="space-y-4 text-gray-700 dark:text-gray-300">
                    <p>A text cleaner is a tool that automatically fixes common formatting errors in your text. It removes "messy" parts, like extra spaces, accidental tabs, or unwanted empty lines, which can make text hard to read or cause errors in software.</p>
                    <p>This tool is essential for anyone who works with text copied from different sources. When you copy text from a PDF, a website, an email, or a document, you often copy invisible "junk" formatting along with it. This tool instantly cleans that junk, leaving you with perfect, standardized text.</p>
                </div>
            </div>
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">A Detailed Guide to Cleaning Modes</h2>
                <p class="text-gray-600 mb-6 dark:text-gray-300">Choose a primary action, then (if applicable) stack multiple cleaning options.</p>
                <div class="space-y-5">

                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">1. Clean (Keep Line Structure) - [Default]</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">This is the most powerful and common mode. It's designed for cleaning lists, code, or any text where you want to <strong class="font-medium">preserve your line breaks</strong>. It allows you to select and stack multiple cleaning options, such as:</p>
                        <ul class="list-disc list-inside ml-5 space-y-2 mt-2 text-gray-700 dark:text-gray-300">
                            <li><strong>Trim Each Line:</strong> Removes all whitespace from the <strong class="font-medium">beginning and end of every line</strong>.</li>
                            <li><strong>Remove Empty Lines:</strong> Deletes any lines that are completely empty or contain only whitespace.</li>
                            <li><strong>Remove Extra Spaces:</strong> Replaces multiple spaces or tabs <strong class="font-medium">within a line</strong> with a single space.</li>
                            <li><strong>Convert Tabs to Spaces:</strong> Replaces every tab character with a set number of spaces (default is 4).</li>
                        </ul>
                    </div>
        
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">2. Normalize & Merge Lines</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">This mode is for fixing text from PDFs or emails. It replaces any sequence of whitespace characters (multiple spaces, tabs, and new lines) with a <strong class="font-medium">single space</strong> and merges everything into one clean paragraph.</p>
                        <div class="grid grid-cols-2 gap-2 mt-2 text-xs">
                            <div><span class="font-mono p-1 bg-red-100 dark:bg-red-900/50 rounded">BEFORE:</span><pre class="mt-1 p-2 bg-gray-100 dark:bg-gray-600 rounded dark:text-gray-100">Hello    world.
            This is   a
            test.</pre></div>
                            <div><span class="font-mono p-1 bg-emerald-100 dark:bg-emerald-900/50 rounded">AFTER:</span><pre class="mt-1 p-2 bg-gray-100 dark:bg-gray-600 rounded dark:text-gray-100">Hello world. This is a test.</pre></div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">3. Remove All Spaces</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">This mode aggressively deletes <strong class="font-medium">only the space character</strong> (` `). It leaves all other whitespace, like tabs and new lines, completely untouched. Useful for formatting data or creating hashtags.</p>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">4. Remove All Whitespace</h3>
                        <p class="mt-1 text-gray-700 dark:text-gray-300">This is the most destructive mode. It deletes <strong class="font-medium">all whitespace characters</strong>, including spaces, tabs, and all line breaks. The result is one continuous string of text.</p>
                    </div>

                </div>
            </div>
            <!-- ... (FAQ section is unchanged) ... -->
            <div>
                <h2 class="text-2xl font-bold mb-3 text-gray-900 border-b pb-2 dark:text-gray-100 dark:border-gray-800">Frequently Asked Questions (FAQs)</h2>
                <div class="space-y-3 text-sm">
        
                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>What's the difference between 'Remove All Spaces' and 'Remove All Whitespace'?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">"Remove All Spaces" is very specific: it only deletes the literal space character (the one you make with your spacebar). "Remove All Whitespace" is much more powerful. It deletes spaces, tabs, new lines, carriage returns, and any other invisible "spacing" character. </p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>Which mode should I use to fix text from a PDF?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">When you copy from a PDF, text often has two problems: extra spaces <strong class="font-medium text-gray-900 dark:text-gray-100">between</strong> words and broken lines in the <strong class="font-medium text-gray-900 dark:text-gray-100">middle</strong> of sentences. Select the <strong class="font-medium text-gray-900 dark:text-gray-100">"Normalize & Merge Lines"</strong> mode. This will fix both issues at once, turning the messy, multi-line text into a single, clean paragraph.</p>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>Will this tool save or store my text?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300">No. All processing is done 100% in your local web browser. Your text is never sent to our server, and nothing is ever saved or logged. As soon as you close this tab, your text is gone forever. Your privacy is guaranteed.</p>
                    </details>
                    <details class="group">
                        <summary class="flex justify-between items-center font-medium cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span>'Normalize & Merge Lines' vs. 'Clean (Keep Line Structure)'?</span>
                            <span class="transition group-open:rotate-180"><i data-lucide="chevron-down" class="w-4 h-4"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-2 p-2 dark:text-gray-300"><strong>Normalize & Merge Lines</strong> is for turning messy, multi-line text (like from a PDF) into a single, clean paragraph. <br><br><strong>Clean (Keep Line Structure)</strong> is for cleaning text where you want to preserve your line breaks, like in code, lists, or poetry. The 'Clean' mode lets you stack multiple actions, like trimming lines and removing empty lines, all at once.</p>
                    </details>
                </div>
            </div>
        </section>
        <!-- END: REVISED HELP TEXT -->
    </main>
    
    <script src="../javascript/globals.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- START FIX: Check if injectLayout exists ---
            if (typeof window.injectLayout === 'function') {
                window.injectLayout(false); 
            } else {
                console.warn('injectLayout function not found. Skipping layout injection.');
                // Optionally add fallback behavior or UI adjustments here
            }
            // --- END FIX ---
    
            // --- START: ENHANCED UI ELEMENTS ---
            const ui = {
                inputText: document.getElementById('inputText'),
                outputText: document.getElementById('outputText'),
                inputStats: document.getElementById('inputStats'),
                outputStats: document.getElementById('outputStats'),
                modeRadios: document.querySelectorAll('input[name="cleanMode"]'),
                
                optionsPanel: document.getElementById('optionsPanel'),
                checkTrimLines: document.getElementById('checkTrimLines'),
                checkEmptyLines: document.getElementById('checkEmptyLines'),
                checkExtraSpaces: document.getElementById('checkExtraSpaces'),
                checkTabsToSpaces: document.getElementById('checkTabsToSpaces'),
                tabSpacesContainer: document.getElementById('tabSpacesContainer'),
                tabSpaces: document.getElementById('tabSpaces'),

                copyBtn: document.getElementById('copyBtn'),
                clearBtn: document.getElementById('clearBtn'),
            };
            // --- END: ENHANCED UI ELEMENTS ---

            const toggleCopyButton = (enabled) => {
                ui.copyBtn.classList.toggle('opacity-0', !enabled);
                ui.copyBtn.classList.toggle('pointer-events-none', !enabled);
            };

            const updateStats = (textarea, statsDiv) => {
                const text = textarea.value;
                const charCount = text.length;
                const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
                const lineCount = text.split('\n').length;
                statsDiv.textContent = `Chars: ${charCount} | Words: ${wordCount} | Lines: ${lineCount}`;
            };

            // --- START: REWRITTEN cleanText FUNCTION ---
            const cleanText = () => {
                let result = ui.inputText.value;
                const mode = document.querySelector('input[name="cleanMode"]:checked').value;

                // Toggle visibility of the sub-options panel
                ui.optionsPanel.style.display = (mode === 'keepStructure') ? 'block' : 'none';

                switch (mode) {
                    case 'mergeLines': // This is the old "normalize"
                        result = result.replace(/\s+/g, ' ').trim();
                        break;
                    
                    case 'remove_spaces':
                        result = result.replace(/ /g, '');
                        break;
                    
                    case 'remove_whitespace':
                        result = result.replace(/\s/g, '');
                        break;
                    
                    case 'keepStructure':
                        // Show/hide the tab spaces input
                        ui.tabSpacesContainer.style.display = ui.checkTabsToSpaces.checked ? 'flex' : 'none';

                        // Apply stacked actions IN ORDER
                        // Order matters for correctness!
                        
                        // 1. Convert tabs to spaces (if checked)
                        if (ui.checkTabsToSpaces.checked) {
                            const spaces = ' '.repeat(parseInt(ui.tabSpaces.value) || 4);
                            result = result.replace(/\t/g, spaces);
                        }
                        
                        // 2. Trim each line (if checked)
                        if (ui.checkTrimLines.checked) {
                            result = result.split('\n').map(line => line.trim()).join('\n');
                        }
                        
                        // 3. Remove empty lines (if checked)
                        // This should run *after* trimming to catch lines that only had whitespace
                        if (ui.checkEmptyLines.checked) {
                            // This regex handles both empty lines and lines with only spaces/tabs
                            result = result.replace(/^(?:[\t ]*(?:\r?\n|\r))+/gm, ''); 
                        }
                        
                        // 4. Remove extra spaces *within* lines (if checked)
                        // This regex preserves newlines, unlike the "mergeLines" mode
                        if (ui.checkExtraSpaces.checked) {
                             // This regex handles spaces and tabs, replacing multiples with a single space
                            result = result.replace(/[ \t]+/g, ' ');
                        }
                        break;
                }

                ui.outputText.value = result;
                updateStats(ui.inputText, ui.inputStats);
                updateStats(ui.outputText, ui.outputStats);
                toggleCopyButton(result.length > 0);
            };
            // --- END: REWRITTEN cleanText FUNCTION ---

            const clearInputs = () => {
                ui.inputText.value = '';
                cleanText();
                ui.inputText.focus();
            };

            // ... (Copy button logic is unchanged) ...
            ui.copyBtn.addEventListener('click', () => {
                const textToCopy = ui.outputText.value;
                if (!textToCopy) return;

                const copySuccess = () => {
                    const originalIconHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400 transition-colors group-hover:text-tt-primary"></i>';
                    ui.copyBtn.innerHTML = '<i data-lucide="check" class="w-4 h-4 text-emerald-500"></i>';
                    if (window.lucide) lucide.createIcons(); // Ensure check icon renders
                    
                    setTimeout(() => { 
                        ui.copyBtn.innerHTML = originalIconHTML; 
                        if (window.lucide) lucide.createIcons(); // Ensure copy icon renders again
                    }, 2000);
                };

                if (navigator.clipboard && window.isSecureContext) {
                    navigator.clipboard.writeText(textToCopy)
                        .then(copySuccess)
                        .catch(err => console.error('Copy failed:', err));
                } else {
                    const textArea = document.createElement("textarea");
                    textArea.value = textToCopy;
                    textArea.style.position = "absolute";
                    textArea.style.left = "-9999px";
                    document.body.appendChild(textArea);
                    textArea.select();
                    try {
                        document.execCommand('copy');
                        copySuccess();
                    } catch (err) {
                        console.error('Fallback copy command failed: ', err);
                    }
                    document.body.removeChild(textArea);
                }
            });

            // --- START: UPDATED Event Listeners ---
            ui.inputText.addEventListener('input', cleanText);
            ui.modeRadios.forEach(radio => radio.addEventListener('change', cleanText));
            ui.clearBtn.addEventListener('click', clearInputs);

            // Add listeners for all the new checkboxes
            const optionsInputs = [
                ui.checkTrimLines,
                ui.checkEmptyLines,
                ui.checkExtraSpaces,
                ui.checkTabsToSpaces,
                ui.tabSpaces
            ];
            optionsInputs.forEach(input => input.addEventListener('input', cleanText));
            // --- END: UPDATED Event Listeners ---
            
            // Initial run
            cleanText();

             // Add Lucide icons rendering after initial cleanText call
            if (window.lucide) {
                lucide.createIcons();
            }
        });
    </script>
</body>
</html>

